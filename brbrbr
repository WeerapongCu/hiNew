-- ตัวแปรสำหรับรายชื่อผู้เล่น
local SENDER_LIST = {
    'upew17bsgl63', 'rxpx58esfi16', 'dghaddgr5479', 'nimcljmq8171',
    'vphspnra3054', 'ssdwybkh7993', 'vgtctcio0109', 'jarrpkgf3527',
    'fzzzytud2701', 'jazqytqr4234', 'zmyjxocw2507', 'hnza21edlj12',
    'desulvur3600', 'zmyj57qxyg39', 'buchketm4507', 'zfnt29flno28',
    'hedbwfyf3359', 'husggwia5395', 'egpo85pmpw17', 'qjnq36uiyc54',
    'txos63kwgk97', 'wehcnajf2756', 'sohacoss7121', 'gvxwhrzv8717',
    'jecmzjss1797', 'oiud03qlzf21', 'ztjp08vube68', 'wukf30tbuy14',
    'nobf64nloc71', 'wulwknsu9207', 'yrdddxss4096', 'jpyldhii0255',
    'swub58pzhg30', 'obrs43hzbn41', 'gesx84gnfp88', 'pndy01jvxu32',
    'tjom98racf58', 'qydojsam7007', 'ZHSileashrqe74412', 'ULAllyndvos10085',
    'BSMyrtiehdtj35870', 'IQMinagcbp18117', 'TTShawnqijc80690',
    'OGNeddaceci93753', 'SMMyraijnv75876', 'LEVaniancpg67570',
    'ADGratiash20521', 'BIFarandpcus63432', 'JIElyseetztd94434',
    'RWKaelaxydv68490', 'CXJuleejavq70780', 'KGAddibxqe56404',
    'CPAuraikay45703', 'QPNeillewbar31810', 'GXEdditwwu15371',
    'EMDorreepcwz00780', 'LSVaniaszvt57270', 'ORAshlierowt26088',
    'IFNattypewr08352', 'ZETeresevtfi58393', 'SGNarikowxhk10235',
    'ECDaffyhzaw88109', 'TMEimilezhpa93796', 'BPKrystamkoe63752',
    'TCKajaovir61064', 'YUElkecqmr13753', 'VXCalleyrnwh90742',
    'GVLottyzklh83510', 'DYLelarkxl80234', 'UCAmitieimnt56668',
    'GCMinnianvg60686', 'QLPammiecgwi31331', 'BSKerrinbpqh55285',
    'NMKelciewlqv11562', 'VCAnyapkzi51444', 'GBFlssdzrg43393',
    'LOMarinfbup46252', 'HNMurielacng32893', 'HWAllsunsksq74553',
    'CBTamarivau56182', 'IZSerenezoty49697', 'AEKarilglxh39635',
    'ERDevabsrk93206', 'KFJoleebpos73761', 'BHTatumgbkt21375',
    'JPNonnahrznq82632', 'UUGenevawfqc91162', 'ZTLichaaoqh65020',
    'BCJilliebslc86561', 'ZFElanadqcb629', 'FIOrsakzjp65841',
    'YIIvettevbmo87832', 'KPAbbencej68338', 'IITabbibafv54760',
    'SJMyrnayiac52022', 'GRDaisieuzog63039', 'YSWallisfjtp34427',
    'HHKorneyosqa80158', 'EWTeddieyirq52364', 'LGTrudikhwp46603',
    'NWLesleyenfr38579', 'LRAdinahgaw41149', 'LCCatilekw58671',
    'HCSusanacewt83696', 'STLoritawlwn78074', 'BNSiouxiaxs83848',
    'NXRaneeznln94336', 'DQBerthaysze63808', 'JHReekxht72204',
    'QCTwylacxhx78606', 'RXCatinamjor55030', 'KBGinnifaow09552',
    'YYWinnyvljn81874', 'AHTeddakjex66536', 'JUCollyknmr62270',
    'OTBinnydnot20460', 'YOCarleymkwv75355', 'ZAOliveailc41507',
    'MOJosiytdv25326', 'VYAlyssanhqn24132', 'PQKatheyjkv68793',
    'FDLyndetaqy31472', 'CXLianafcln01577', 'ILEllynvijz23118',
    'DJMablevpfq21953', 'VUOdiliagiws05636', 'MEKittywrib02709',
    'WSMyrtiaezlo93145', 'QZAilisbnej78021', 'KGJyotizsrq01596',
    'WFKifscq63429', 'EOCarmelyhow89168', 'USReginajevs37564',
    'GCEydeblkp70235', 'HQNadeenkeut39639', 'HKDedralltk43214',
    'QTEmaleejvek15633', 'BJAllynplcb62409', 'NPClorisewaf94365',
    'JKRhodiejfiv46288', 'CHKevynsskf71124', 'RYBessieytln23875',
    'MNAmaleaiwlw38404', 'REGayemszu74687', 'HBEileencevb37875',
    'EZDrebgpg75217', 'MBRoanarmta67239', 'TSMinniezyjm26857',
    'GTEstelqiwh65988', 'MBAllyyoqu90159', 'FRVikkyzxcq67599',
    'YXTonyacarb51773', 'JUPhillykkyd04317', 'AMEdwinaduhs02427',
    'VSHedihvpy83113', 'UMCariamrsh73869', 'YZCymbrewfyr73081',
    'OZRhebakirn08710', 'XTMaerwuo04089', 'RJTanihsfq51643', 'RADustyzywp49280',
    'HOShelbiueqt57149', 'QNRoxiejtzt39637', 'GUAvietrpm66556',
    'CSRonicajvra60661', 'IFDulcylnvx47431', 'PMCeliasxjv13967',
    'KHDagmarvayw27686', 'WJKieleltde01442', 'YPMeadbbqj63541',
    'ACGriergbhh79016', 'WOEllieruiy98667', 'KHClauderzgl31677',
    'HVNorrieswmg15912', 'QSKorenlgmr87164', 'TBGabiljev49154',
    'QBPersisoxze14821', 'JBOonakfjv88856', 'SNKelsibnje45277',
    'XVPaulieuuyd91481', 'MLAlayneozuh75673', 'WFDashaiehl54779',
    'NDAshlazmsy06407', 'BXMelpiaf61912', 'EBCharylrakf76590',
    'NIVenitazqzs22712', 'RIAlexvfjf03167', 'MEMavisihsh40871',
    'MHMidgedcay97807', 'RDJanelaqjvw47724', 'XKDyanaiizb20267',
    'AGCeleneryjb01697', 'HACloekffu43899', 'QDSybylzqoq03235',
    'WDNertaxasn71767', 'UXGennincbl47556', 'XALilyankmjy14568',
    'JLErenamujq18726', 'FVUllatymy48625', 'BHElsiyfff64499',
    'AKVernamopm78158', 'HYPearlalfwj39609', 'VUIrispnln81980',
    'CNBiankahvxk52887', 'CQKailecobv42616', 'ZNDaceycvoh29809',
    'BQLinnealpxj93071', 'ZRDawnjhiv88728', 'WZJobiehpoh68625',
    'TGAlbinaevxq75183', 'NFDulcygawl01403', 'RZZarahwsnv30334',
    'ZXRozeleonvk85960', 'JWErminaifuz53032', 'MMKarleejzqa13652',
    'GFMarikwq30216', 'JMPhiljlxn02721', 'GVYnezxovj42115', 'FPJainevfgh83231',
    'TJWenditvqu68997', 'QXDitakbyb98049', 'QVLilahkaon70729',
    'ZAAmaliexxbb10749', 'TBDorisehjyt93675', 'KKFelipaenke46352',
    'BAMaryscxv41854', 'XMGretnahdbi32742', 'RXGennagqnz89358',
    'DHMyrnatexk70546', 'YNAndiezsme21403', 'TIEthelcxth91909',
    'VZVerenedlvt20439', 'ZLAstrapbgf61989', 'VHSadiehofy62795',
    'ZZDevinitvv75725', 'VDRoslyndfuu68113', 'DRBrierybvn55958',
    'HAAshienekwa41950', 'DVKatasuug19212', 'BNStaceetcfe45844',
    'ADAshlieauuo61898', 'MGCharinxuua05387', 'EWBarbeetzij15556',
    'AASondraxksh46753', 'IHCarorpud91496', 'HMStormotub24004', 'uecq76jmbe29',
    'ylva09ihay81', 'rrpd11moti94', 'iczd43ojlz30', 'agvbiehg3611',
    'vrif52ucrz30', 'beoa05bsog95', 'eesmiwgi0277', 'mmip72jbnh86',
    'kvouhxlw1158', 'wnyj34kqvp10', 'qhmbtkwl9973', 'ntoa72zkwd08',
    'prbdqjkc6170', 'pgdcswnd2199', 'aiynosuq4127', 'cwsodcpa4332',
    'qicaarky6422', 'czrtgsie4284', 'stdjwjjc9175', 'usel56fdnw16',
    'wqcexrsh4063', 'ubtv73runq46', 'jrtk98hygt04', 'bgjo28arpq07',
    'cratylmi3147', 'bxsv40qlnp05', 'vtavvzwz0431', 'hqbn23tqyd66',
    'poae07hbdc42', 'vazuqcrz8335', 'wiqc31rbcf72', 'ypuz81xvnc87',
    'ylpw84vgoh25', 'jjls17bdbi33', 'scuy84xwuq05', 'pxedwjha8290',
    'weqd92kzat07', 'vtky07lvtu35', 'tazyanmk9804', 'ucsu79jewj34',
    'fruw31bbbx61', 'aqvr85tnev80', 'unzttmvt7987', 'titnmrjs7421',
    'whxl21bkwe92', 'ysjgyjnt7954', 'cifl81rxab62', 'tepb15bpst41',
    'mptx26wfof32', 'alupcciq7941', 'whpvycob5190', 'jzwh82ohta87',
    'hgbbrlxg6720', 'pbcgrqbl4844', 'dtum28fngr35', 'dcds68zrvr38',
    'dwac25uzvl42', 'jokjckns2400', 'mpib85icqb73', 'iivamdfj7028',
    'qoixcamn2518', 'mcfq46vojy32', 'kvtmzcwv1780', 'pxnthrie7899',
    'cznpqtxh4625', 'tqsc52qxoz36', 'zzft09eqke42', 'nytf79jpkc29',
    'oqxgtwhu2144', 'iixkwdly3110', 'sowg14vspk04', 'dkpssjul5745',
    'jkdh87svgh09', 'wpgpbobh2970', 'izto70eott50', 'thmh16elmj09',
    'nvcmqqzp0290', 'mypqcanc8361', 'ihzqqksk2609', 'nqmtinoi0626',
    'mnmt11wehm41', 'HXPiafhtf56145', 'UTDanyaoork36744', 'LXMadelhway07927',
    'IAWinnemkxp19292', 'JKAgnolaqeoi96519', 'YCMarniahggz13450',
    'DTSelmavhfc40704', 'PGCassipiaa50724', 'PAAudryeloxo58767',
    'OKPansyyusn70840', 'MOWallylhml53447', 'RHLinniecaur20218',
    'LVZaharapjzi54945', 'CRElinorxsra32671', 'PCOrallesxhj72972',
    'WTDionvqes83930', 'JAAudiejvrz76576', 'EACarriikbl25851',
    'ZVArethaawxp48821', 'FQTaraagrk58979', 'UIDorthyywrt89174',
    'PMNorrieexzp90146', 'FTFaunxtyt15555', 'HLFancybtdz07897',
    'XOErmaeiyu73968', 'SMLuckyzkcf40528', 'IVHarlieltnl34006',
    'JNOlenkasgnf66586', 'UJNanineqqzk53735', 'ZUMarenaalkr49278',
    'EICristyluqn39301', 'QCJeannefsur73801', 'XWRobbinpgjr07976',
    'OTDezpew42923', 'IYAurieodcm25477', 'ONKaylaoptg55027', 'HOMyrahcwbo05596',
    'QFCandraptis38304', 'QPSibleyhkau99322', 'QYDulcigoha95914',
    'JAMargotwtly00205', 'UYJoniqsxe24180', 'WKFaunpjlb45686',
    'OOPammyfqhi50712', 'YJCristiojnb36113', 'XAErdaukdp43823',
    'LNNonaxpes84435', 'QQBennypuxq08312', 'BYFawnohmi43787',
    'EZWinonaqppe63151', 'NWKoorxql42629', 'VRNanceycbf96407',
    'NSArlenawqdh28640', 'SMHedvignvqd58023', 'YPAllycelqbc64075',
    'DZLibbylgec61551', 'RBAshlimnlq82307', 'YHEydiedyct24391',
    'KYMinutnd96658', 'YOPruekozd55265', 'HCAngiefabu96975', 'TMRahelonqo36728',
    'CWAlexiajlbl93001', 'EKMoreenowof79855', 'OTMaryfoyc59207',
    'KEMaetrhe00902', 'HLEricakvbv36807', 'EAPaulyikdz04234',
    'NRDonnaxygi18114', 'IVBeckyensg63482', 'HLCymbregwwp86229',
    'EYFidelaynza40571', 'NDMaxinepurr49079', 'RAStefabhnp70254',
    'RKAilinabeyv00083', 'SPRaniabzlq24726', 'NTRozqtcj68222',
    'VNAllenetgax75952', 'UEElkaiywh64680', 'PRAndriaizfn00283',
    'BFJaniepiba46265', 'EOLexiknmm80773', 'KOWandiebher07961',
    'NBAubreygiir59044', 'gtqrufah5106', 'aqmz00mdhj14', 'wokxzcnj1671',
    'lczsgbkb8275', 'plougttz3059', 'iztu14vtnn05', 'khjh13bxno51',
    'kjxr81blqj99', 'fsmgcfms0122', 'ticnoqxq1312', 'rvvc18chtu65',
    'jascbsna6156', 'vxro07tpce67', 'ohucsqts1582', 'kleuogej4075',
    'cxpu35kvtv86', 'tmuvgbsv6249', 'liayqcos2499', 'adrn99fwsr12',
    'krfq22tdvc64', 'knecnrdx3615', 'gjurjbgh9893', 'qwjv72jyzi30',
    'jcjvznzr3648', 'gphflhiv0626', 'lhylbtac3285', 'scopczxo1844',
    'ycisqxil2713', 'gojk25mppc95', 'jebv55ikeg96', 'sbohefyr1643',
    'fyet55dpyv65', 'noawzxay4673', 'gnejqmie4389', 'thft70ifjq94',
    'xkcf09mprk67', 'ergqeojn0739', 'hspzxhvx2686', 'akykmngm1986',
    'mrun57ktwt19', 'fprs05gbzg55', 'OJJuliabzoy22116', 'EXStormyqld72407',
    'BKMyrtiagtvt56938', 'KSNannyvidq24518', 'LIInezlhbg05824',
    'MFAdeyxkrn76868', 'OVSimonajvww31061', 'DVJinnyckby10607',
    'KNWrenqbxx03729', 'XSSonnievnnj57302', 'ZNLishaxosy55894',
    'BFDelorasyzr27583', 'JQFidelaqoln10618', 'JULivvyddad63966',
    'IFPhedrarnsx48862', 'HFMindafdjj76626', 'AWSelabggs01638',
    'XWErinaeqig24096', 'CJKathevgkd92525', 'NDMoirampdk88704',
    'LVTamikobttp09483', 'VNKaliemxjm75189', 'AZVinnyecrg34011',
    'UHMalenayofa18794', 'JYHertarypz88191', 'IFRivyeeif30236',
    'ANDonnyiotr60640', 'LCEdithjnmz83390', 'CAPeggirevq11762',
    'YLCyndiecmsw65816', 'KVMonahgdd65197', 'FYGianaqzag89009',
    'VHWalymput99412', 'EYShelbiulze40555', 'WBAerielyiqi37513',
    'BEKatinehexs28214', 'WPThedaxpna73421', 'PXDavetahwal92969',
    'TGAdiedks63427', 'RJKieleefud12200', 'AHBambisamz31612', 'HOUnawtpm07957',
    'ZQDorisxjdp09059', 'KVRiccayxzr01670', 'GUWilmaucca36856',
    'CIMindadrgq31794', 'IAKelsipujj15055', 'VDElishaxjcb52874',
    'JVSybilatuil55472', 'EGBrianalypb03781', 'IVMitzibzyg20302',
    'CFDarciethct28012', 'NZTeddavujd39596', 'EAAdoraexmc12533',
    'EMKooxgcn72933', 'JSCatheeazgk73271', 'LSOlympesimv59034',
    'OGLorenedfyv77712', 'ZLValrymfbw66763', 'WXRicixxua33125',
    'ATMarysxrpb13317', 'WXCordimiqb68756', 'EUAlfiwqrb03648',
    'HWAshleywyju82879', 'PURianemoux05508', 'URAradpnn67196',
    'XTAgnesehwui56757', 'JWKajajeiy19839', 'QXZariahaku45790',
    'PCEdihfsw26452', 'HGBrineyuwyo56378', 'BYDaisimikx31439',
    'TFRosanamczo36127', 'VRLeilailoq81395', 'WLOlayspx32311',
    'OXArabelwyhw62171', 'EFZondavmiy18637', 'DJLanizvrj08146',
    'TFLeelahpewp15090', 'CDKareetjhx86680', 'RPMirnapyjf97330',
    'CTDolliakjp03485', 'MZDorenebfgc84641', 'ZXAnyautlw22662',
    'SYNonahunss34208', 'LLSuzieobte00861', 'XLRivydhqd99625',
    'ETRicarymk08559', 'SDCornyhqsj33242', 'WLMollnurn33333',
    'ZLOlenkabqtf01714', 'QVEboneeaftc03178', 'WZRebadxtx23915',
    'HBCallikofw78494', 'VAAnnjskr58242', 'GNCielgeap08352', 'YILulawftw28044',
    'GAFrediafimg79370', 'XNDoniaotfl03180', 'PJOlympeondk82410',
    'NKKristesimi55258', 'QFWilmaayfq42281', 'OHSherylfert48696',
    'GIMelonyhktv08656', 'KRRickieplqg64737', 'ZGCaresatyzm18277',
    'DSFelipakqqe75026', 'BCClairemjul41224', 'MUAlvinaoynp16894',
    'VZAnnadame29615', 'GXStaciifye52068', 'ERNoellatffb31159',
    'RRDanicexhaj27907', 'TJFlorwdwu09849', 'LEHildeobjj67147',
    'INLanaebikv59532', 'JBKylilagxhe38996', 'HNLaurelrtka41379',
    'GPRheajoek19797', 'WIMartiehvg25661', 'DLBethplkj10274',
    'NACristiocsn85224', 'UKMelisagwrl56508', 'QAMerryrzwj13082',
    'MDVivianushb78734', 'OJEdalghc47714', 'XUBobineyhkf43523',
    'YGKevinanmao25251', 'YOSeliaainh85923', 'XVAshlaqvnr21535',
    'PUTrixiebsov74314', 'HHMollpztf49530', 'PWNevsaolhf30491',
    'WCAileenmrtr97596', 'URUlrikesglg98774', 'OBVikkizdvx61730',
    'DAShereecpbl13993', 'TPAlydaaiam23209', 'REMarjepwbx49803',
    'YTAshleecxno76368', 'RCKattieoqlq71760', 'AUBambilfwd81318',
    'KXLouejbd62778', 'MQHeddamxyw21315', 'KOBobbieklfo71078',
    'MGKatlinzakj91025', 'WRAdorevkqy18319', 'MJJemmietxag54248',
    'HSArianaskbt60695', 'OGOrlyiebv96104', 'QXTaliayjut49639',
    'MOBarrybaya78200', 'CSKassymjg42227', 'UBMarciavrxp80683',
    'HPCodiebdjf25939', 'QOCorinaouny24143', 'XTAvrildoux44794',
    'DHRianonxtcg80678', 'VKSareekfzt18783', 'OHGreteyuse30368',
    'JKSopheyoxaf27139', 'FQSilendhk91491', 'WFRhodiesupx39275',
    'CRJorrylxrv63251', 'KRLanitajkur75650', 'WBLeonamluh81475',
    'XZAileenwrpj95917', 'FCMaritasoip20554', 'QZEtheltime48552',
    'ENJordangbfb21746', 'JYAgnetarflb68310', 'NKMarnerxkz30814',
    'EBIlsebmeq89258', 'OTBonitajzur92231', 'XPCasihnoa36261', 'UTDoegist64237',
    'ODAlieawzt60331', 'ZXSilviagyth16942', 'SXDrusienwaf95776',
    'LETobyeaawq89710', 'TIMelbadvvj80662', 'WUTimiicwz44331', 'GZGuivwtm93339',
    'TPRomonadzbs07741', 'IXCallygyfx90816', 'KEElenavnki12003',
    'WDLucitaffqt89230', 'YDIbbiezvat77235', 'MQUllapjrq58313',
    'BZFlorewjgc91386', 'ITValjfza38939', 'QTEvannezhqh06961',
    'GQTobyesryx58141', 'NLTessyydqo89872', 'FYShirgiff75456',
    'UIJoaniemwdy37132', 'NFTalyafgbk42951', 'NIMinniyphv96123',
    'HNFaytheactj25041', 'CXIrismwyp13935', 'CNSarinaofdo60818',
    'NECicelyfqkb65544', 'FDCesyatqdr12951', 'SVBunniptxi82627',
    'MIAgnetasuel62001', 'ILBambyxaar32707', 'OEBrandyyzhz54880',
    'MFBeulahklck30875', 'WPMaddyxdqw72933', 'MYDeeynnnpv78122',
    'YFAllinahcny85666', 'ZCDreddyppez38534', 'DXAmilbkdh95538',
    'LTPepitaixgq67166', 'WDHannienqyd60504', 'QKWynniexibi01256',
    'JNAshelykwri29302', 'CURiciuuro98494', 'EGBenitakcal05347',
    'FXAddauvlf53111', 'DAAdelmykc48353', 'VJIlsadatd70779',
    'DYGodivassqg41887', 'JNDynatble43299', 'ACAmiogzi21470',
    'GLAlliedeea84020', 'YSJillyhhln86971', 'WCHannieyhvj33420',
    'XNRomygezw13434', 'AJMilnfga71635', 'CZAlizanuld77394', 'AMLindatxeq60194',
    'GWCherinpnwu16562', 'CODannawwhb02664', 'EZKaseysskm72363',
    'MCDallashrrf46284', 'GZDasimosp61878', 'ROBertydznd73701',
    'CXAdanyxbm61972', 'TDArielacpsl14003', 'QRDidoffrh84658',
    'JQMellyqqrm42018', 'HBOrallakqjs85284', 'CCGeniabytj13272',
    'BBLeolaekjs90726', 'JOJonieeety25433', 'HTJojoykez19403',
    'ZPLizzywhnx26137', 'jwyp91volr31', 'cqlxnbsl9175', 'docifldx8546',
    'kbrp75epta29', 'fvhsuajz8580', 'romm71fnam85', 'wbal35ealf42',
    'ippj73eqei11', 'oslf39syjk60', 'yttn57jkzg48', 'ppbg02qpso09',
    'ryjulmoi8336', 'rous32qlvl64', 'zhkb09nbdt82', 'qnavgpwl3171',
    'cfgw32cdwa23', 'rqlc59pzfv58', 'cjepcdor4814', 'pdeg09euze67',
    'hvxo51pvlr23', 'njbprled3047', 'rqljlole8590', 'nhqskzkl7109',
    'ztzk41bheh00', 'jfhu66stce09', 'mskqevqk2408', 'gnzbczxn0707',
    'asitrkqd2004', 'yvvv92miux39', 'rfpf57jjmr58', 'upyl29dcmj52',
    'bdkm52zpcr76', 'mlwuznqj6683', 'gotp70supm05', 'gjwh23byjy53',
    'cotp87qoqz33', 'lifyfyzg8704', 'tmnr52uprw36', 'yiejtplc9095',
    'kdoktczs1775', 'hacy29viaq41', 'FJDagmarwymz21846', 'TMOthaezzr62625',
    'VGKaelatxrw95483', 'DTRanazwlj15991', 'EYErdaldpy83976',
    'XJFloriahspt42832', 'UHLaureeuuec80597', 'RPLucineglck74352',
    'HGIlkadyws16108', 'OUFionnaskyx13123', 'CQRiviwtym79723',
    'VOJojopvfg01301', 'LETawshailmq91963', 'SHJulietzfey25469',
    'SVSharlaevdn03663', 'QYNertktql13963', 'IWDeborkcwk30802',
    'AFRenataxgzp40016', 'QSTobiwkqv64697', 'XVKoriibal43943',
    'GNSheriecvmh81224', 'RSLissyuwrl15695', 'VQRuthydjvj79297',
    'QZDalilanfxj14106', 'TEBarbyclmg38356', 'YLLaraiuxj91440',
    'SFUlrikamjco88270', 'AWHestiagaji28116', 'RPGayleyxnj36065',
    'GIRhodynzzx17897', 'LYValmahnkq34275', 'VJAgacecgcn17168',
    'VUNoellegsjh98876', 'MHLoellaqfqz70791', 'WSLilianwxcl83655',
    'LMLizzyekwy14885', 'IFBessymrjd18258', 'KBNoelleizhi94596',
    'LVLettithdv91126', 'EHBlinnibjeo92905', 'JEKariijox39546',
    'BBNariugyu29012', 'DTGwynnepuik32370', 'VEAilsunieze99687',
    'JQJodybwbp50418', 'FDDottivgfb35749', 'XHKarrahyvmo92089', 'UJKiatpp41528',
    'ORDaphnasqrg44345', 'EWLeilalmvy80520', 'LJMeaganiviq32473',
    'LRMyrtiegwqs21690', 'CSHarriqwvc65608', 'BCEdnacbhv13935',
    'FQLacyvjjh80338', 'RPConnycgkg76644', 'QMCielqkeu26308', 'YBKiahodel52065',
    'PZElsetlhxs43995', 'MRAgfgnd85483', 'UISabahotb87121', 'RQErenasnot53185',
    'SUEmilyumjq23433', 'PCEmerapbte14048', 'FSRakelibjg09080',
    'SYAarikatwgp30978', 'DKVivaobzy54908', 'JXDarylcvpi48840',
    'RISteshanqrb26441', 'JWOdilleiuzn10292', 'RORosawfcz34511',
    'QRAlfyjavp68052', 'XVHedixhpe97238', 'SYTonyzfez49451',
    'WURoxinecxjl61242', 'KPKizzeedioy75782', 'TCLegrawvyo66196',
    'KIJaniaydlx25286', 'ZGNinafhum51523', 'VWRiccaqrsk05832',
    'DQShaewefe59565', 'FTPegeenhphz70407', 'syzh87mqhj15', 'pduv99mbvd22',
    'kgzo98fwih88', 'kwji55qcgw90', 'ryfc28gajs40', 'lnbdgugh8803',
    'ywco37nvms66', 'zjfyacgg5477', 'umahxgon6831', 'kojt16xznp62',
    'umgdtvoh0901', 'pmap04zmuz64', 'pjrh99iuhm90', 'uegfvrhr4186',
    'xharnncj5374', 'noxg95iuiu57', 'wlrqmieo3576', 'fajfxlvv0567',
    'urhjpral8068', 'mcix28tohp14', 'amhtmrfn7233', 'iohyscid0786',
    'ygipbzkv2742', 'exkg22lbpm52', 'fkdl42avud83', 'ftaxeoud6076',
    'ormvtadj8023', 'ogpw64bwut98', 'vluj80btmh61', 'qdnyrzcx3412',
    'ohxtjfph4621', 'fnol10axoj78', 'mbam91ftse18', 'owbt96tebc15',
    'kenzchta5523', 'kvcw75zzqg90', 'iryjuogh6442', 'owch25hlok68',
    'tbsn52pzku49', 'oosi38utkd00', 'vdbmducr9454', 'hwiubuyo0744',
    'sass01ejag34', 'cdyv01wdfl89', 'hsiwhwju8720', 'aign56swai85',
    'dclnuxuw6882', 'hwax30ynnc13', 'pahnenyo5057', 'ivogwqzb5091',
    'vcwr97uvhd82', 'ltzp25pfzo16', 'yvgbqkyc9153', 'xpfqorpl7857',
    'hvxvtjqj0164', 'ngdccpiv7360', 'cnfaryfh0880', 'vhax53vfyt60',
    'cmommqwe3713', 'xizk48toca08', 'zsoreumm9762', 'nvwm57uvyg43',
    'wxcr52wstm04', 'gwzl86upir59', 'goib59lhzi20', 'zviwqufg6687',
    'mqgu44rbtp46', 'vvgoairw1637', 'aankycpn6681', 'qtrqrzdl3895',
    'aazb55mkho99', 'popndlzk5622', 'obqv12dlcd60', 'zcyu23clxi44',
    'yxglizsv6327', 'qkmaiqjp5557', 'rjilmmcb0395', 'kulj06eyuk27',
    'utfodmgi6543', 'raxd77fdqk13', 'rletrngm8990', 'fnyy75oagi99',
    'ktxx07hfir44', 'zics28fubf08', 'qvpjwkdn9572', 'rozi88agwm46',
    'jqan42qfna78', 'nkrwqvif3566', 'kxih87piks29', 'wdjemjyc2775',
    'jqxzdtgv9968', 'mzoisdcg8265', 'tjgu44yofz72', 'mvtbqmgl4950',
    'zcuhrzzc6145', 'mhyz68bukj12', 'uvjcahpu3003', 'otuzyzxj7038',
    'goudaflz6798', 'nfbawakj9232', 'tgyc53azxi26', 'llfu55plql41',
    'cdnlqehi9176', 'buvpvavf8542', 'fuhlffza8441', 'ftsn22pvin86',
    'dacubttg6247', 'qunadkgh1638', 'qfihlssx7020', 'agyfoyac9409',
    'trdfgzxc7605', 'exvxzbrj4991', 'xhcg45apne33', 'xyvz01hznx63',
    'ezuz50ezfy40', 'estk26bhbj23', 'bxaspzlr1902', 'etvk06mhfn65',
    'fojk37qetg24', 'oxxw53drrz74', 'ugvp77exgk16', 'kvre23oknz99',
    'qmaeedoq3740', 'uwhu80rukv55', 'rxnv10zfiq63', 'rmikqpnf7216',
    'fnvz54bmyg06', 'utxtijbn2649', 'gosn28owwe04', 'euzpfeey4826',
    'yfzbzeqz9308', 'pslnshav3052', 'jlikrskp0753', 'mvoz12zhkp70',
    'ebeyuiim0567', 'lbgvvoea8427', 'foon71qrtf23', 'ealgtfdt3740',
    'etgf54agxr94', 'vcuqinoe2217', 'yxvfeidd5461', 'dpto82ltje00',
    'eeuwyxjo4071', 'byvj27ufca84', 'ziwclywx0982', 'siplcugy2451',
    'dbbc88ocsd71', 'zaqs29mzus89', 'kidckwiv8358', 'gargjbcg8189',
    'uczoidgy9757', 'apynuuqr4966', 'mlhbtwdw5006', 'kbbucsgb2326',
    'jqeb88szur55', 'hgmp77bhub05', 'vhsjxbol4913', 'dztj66epaj40',
    'UUEditatdet92297', 'BULucisrav89571', 'BEMarthaghyi81012',
    'FNRosenesdei91075', 'LCPetdtdx00003', 'QRPauliixmh00252',
    'STRoxanabkfo65380', 'VWRikierpz77179', 'KKLuisaopub38220',
    'QVNeliedtls12542', 'DSJobynajakd17329', 'TCAdenazjcn16756',
    'ZIKalliznvf58539', 'VDHeidiejjsu81812', 'CKJoannevezl35334',
    'IZBelavvr35125', 'EYAudresjqe45644', 'QLNorahinva51684',
    'EISelenevpoa97095', 'HSBerniemjyg35596', 'MZEvvyshwm26622',
    'AAIlyseelmy00778', 'XBTandywgvb41803', 'MCDanawrmv31514',
    'QBJuninanzqp89167', 'FZAdellehzeu79446', 'PEMyrahgfo43817',
    'OPLynnkitc00390', 'PBTishascgz63589', 'KSKalinazrii07337',
    'JEDanikarbwz05418', 'JEKaniajcoy78374', 'TKJanotbuus83110',
    'HCRahelwffo93572', 'NDNadeanollg57249', 'OBLottenvxa59828',
    'FFFarandgqtl72468', 'PFSerenaxztc57139', 'SIVannidxhh67209',
    'DLMargoahor14570', 'BRGiannapfel44945', 'PRBambievlrc27734',
    'JRFloripsne21520', 'AGDarciffhb76039', 'XJElwirazero01500',
    'SGNancieamlc79257', 'LGGabeysdhy63667', 'YNFrannyxblp91261',
    'GBRobbinvoce69933', 'FRMaviszjyf34354', 'WOKelleyrufj15561',
    'XMArdyspafd48908', 'RHBritnijcoo48264', 'YPJanithbnoh74676',
    'WAAlvirahske86516', 'UPIzabeldwap88885', 'VFBibbydlyu68197',
    'THLuisazbet31352', 'RPKelcirnae65010', 'MPKalinabidj11864',
    'GNTynelszu71457', 'QVReneeethr12690', 'VUJaclynckwq95329',
    'OQLivzepk09341', 'SNStephijx2193', 'FVFeddyhpbn02478', 'RVDrusimipi74772',
    'NPDustyuzeu86843', 'FNHayleyzqzi51063', 'QAJelenelazx44874',
    'ITDorisegbka12586', 'KQDorriwcji05914', 'GJElseteemo94176',
    'NCVikkytprm05794', 'MKPepislca60218', 'BNXylinamgps00052',
    'BCAuroressld16972', 'DQMintajgcg74949', 'ZTTriciaaaja78670',
    'MCCassyotrv94969', 'WGOliviafjwm87789', 'XRCordiecaqo13104',
    'MLIanthegqls47536', 'OAKassiatdi71073', 'eyux74bwpd34', 'czyasufe6270',
    'svlc06swbc44', 'xrpjzdni4597', 'lqgnoamk5464', 'xtop26rdsj64',
    'bmeu38iatg72', 'uyeyrzya6334', 'cunh91uqkk79', 'zlzvcffe2133',
    'iccw94kfhd96', 'siwj97rhzi09', 'lfrxzeta6477', 'vpcifiwy2883',
    'ihja43iujp15', 'qkghxvax0378', 'ucxe54gofl38', 'ejur60eooa27',
    'ddmxojrm9201', 'rijbdkdq7160', 'ielqtdgk9593', 'wrsgludv9347',
    'macm85ajrb22', 'paseblne6630', 'vnlg55gvbq43', 'uxnz37gblw21',
    'hivynpmq4350', 'tuibslmn7965', 'gednpxgc7160', 'siwblosn2539',
    'xwle65rtty29', 'ultp06hjag77', 'qwetzdzm9327', 'qhtkrluw9498',
    'zgjggiox2097', 'bceqaefu8239', 'ajxs41ewew99', 'kzrsulck2828',
    'kgsg35fsqi23', 'omqpweky5938', 'esjg09kuve45', 'gfyeatxx7334',
    'bhhzbxue1309', 'xuppseoy5410', 'kacvobrf4913', 'gdxs51ecrt98',
    'cwkvbnms0261', 'lwtd49ouph06', 'arko64bmjj46', 'qesa02sgci86',
    'wayejdzs5141', 'iumsharn6363', 'ghyylbgn2139', 'iaehtpag5574',
    'cooj67kgpo37', 'herukzps2757', 'yeyfvpkg9567', 'wxauuigu2242',
    'fgya54htmk43', 'ddsz50tjqg49', 'zwdn10lbny85', 'ajyawlqf6524',
    'stsbgmjz5289', 'jhukmtzc4142', 'sflxdjpm6833', 'ovckwrzg2637',
    'zoqj34avhs34', 'ctbcwxim2467', 'gisx71hhbm23', 'bfgk29xgwv70',
    'vwwdcrwq7648', 'pbfbizvs8068', 'jdzk97eroa45', 'kcnurtwu2964',
    'awhgxhda8285', 'osnzdcxb8491', 'bvdzmtyc0878', 'hgnc04rtvz29',
    'dkbs61pqsu27', 'bnly98zgpz43', 'rfbacsav9557', 'hjng22wgjh57',
    'harzajcd6499', 'ateywhyg3660', 'mewgvhbe6073', 'luvf31bnzl68',
    'mqfeclcs1035', 'smesthxa9304', 'dadrnncf3817', 'xhuyizub3198',
    'dvou74fjgy02', 'xeax12qmct93', 'hxxu53ecll10', 'jqvrwqqw6778',
    'lpim16vwlt50', 'deqh80yess73', 'qrus98rpnx47', 'ozgdzzrs0024',
    'hqgu61xldr57', 'dehd80dahu04', 'eiws04hlwo98', 'yynnnukj5201',
    'scyjqijk1661', 'mvzlcvfb5662', 'xslazhof5726', 'ljxryxfz8950',
    'ilwe36hztb53', 'srkb15yzhm05', 'dofj11rdyk09', 'mszbrvmz9645',
    'tzdv73ggfo10', 'pixhuovb9880', 'zflsvhui2029', 'dginkcmg2704',
    'thsj01msnh65', 'gnounbjx3207', 'eqmo86wbnw19', 'tyhruxyr3823',
    'oujl11abeu06', 'knjuddzw6587', 'mqyb09dcto02', 'vvnn70dqsx46',
    'wmsskslo7966', 'ymgqwzor0815', 'vten44fqyu35', 'wxav10pcvv61',
    'agdc45fdxm70', 'rjnx45vaam47', 'zxeu46gufl73', 'ntnh20wmkx09',
    'iggw67pjvd97', 'dybweuse9236', 'gvfv05hyxw49', 'mjcvpzlv7283',
    'lejs30laox45', 'bulp56gycp65', 'ypxc86embq44', 'zmjg13denx33',
    'qxgbomxb9780', 'gzkl53vmrt20', 'fjltrdoh7148', 'zqhpgcxg3928',
    'qrvh23ypwz87', 'qisqwrfv2191', 'ntpeffmz0378', 'bvmetxna0739',
    'mjihjpxg5321', 'lenszkxw8194', 'kncp97fzwp14', 'xfyazefz7991',
    'yobihqfk9935', 'yjup98rlxz80', 'cfugfbbe4553', 'neuz28jpig22',
    'epjfafjp6223', 'rgnmuamj2222', 'ljei41oxub61', 'ldpl48khzj93',
    'ffcmtkuz1662', 'xneo18brao31', 'lhqf62hzhb27', 'vfkl75xmzq73',
    'gykg17bqxd62', 'vgcxzskq1884', 'evgg03jdna42', 'epdovhzh9343',
    'srhydtdl4460', 'smmj40uvvd92', 'bzgjedfk1759', 'qfizulob8021',
    'ygeixgez9432', 'xiaovros5902', 'yoqnrrnu7651', 'fzxn80gxkb28',
    'akbimgsp4763', 'jznttvjw1551', 'dgqnexyh5557', 'ksza59csjl71',
    'ybkk08ddyr74', 'efos27zcvb35', 'rojxvpji2135', 'yzulzpan6282',
    'zqpm45ptoh25', 'zacggitp5963', 'pnbh29kjoa15', 'opxt44rjmd24',
    'jkwkvkse2981', 'hedm50mceo26', 'mcvucaef7673', 'zyahcrjf1920',
    'hlmt96fpde17', 'qgntlpjf6536', 'iziq10hmkp24', 'rnqknmgt4589',
    'hlfpalcc9195', 'ajaawrkd1067', 'dnpygerh0453', 'pnuq59opff70',
    'evftmrvu5334', 'jfxbefch6156', 'mbniwtwt3580', 'girhpczh7609',
    'ncqv27zqxf85', 'iconctyc7067', 'wzsxbuyl6302', 'fqtbbsrk3605',
    'lhsi62pjad51', 'xsxlunum0922', 'sgprotsu5415', 'ndko64awan99',
    'zqzwvxvt1322', 'cerkksrd2497', 'oqwsdqco0801', 'zqag84vpfk17',
    'nsqjqzrt7384', 'iocm18dnrb51', 'rkgupyez8160', 'ruvtnqig1728',
    'iubi90agiw02', 'qkyd15oogm79', 'sfzhadiw1950', 'nzoqxzqo9082',
    'egqktyzy6490', 'gzlccvru8949', 'gtltumnl3007', 'rrwbfqup8935',
    'xqyx47zeyp00', 'ehnm35kqmf36', 'gexxkdbv8285', 'crqpunzu2478',
    'mkvr72yezn76', 'mbgmpiwc9408', 'lyun31fwwg46', 'uhkw47fgaw84',
    'jddd17ipgz67', 'jjxm26qeya17', 'bnxv67sdel76', 'NFBidgetdkws55944',
    'VTSonjahkbt80106', 'PTLivtuvf17599', 'OODoriseuldc09468',
    'ZLPansieyvql46018', 'OEJohnnarwmf47334', 'VAKettiydra80010',
    'RDLinneaqavt24147', 'CXXenazdif98233', 'PHLivvieynjb43331',
    'ROAdriankmgl07852', 'HBTricianfes60573', 'TLJobyevljg10915',
    'CZBrandyrbqq81460', 'DJValligqfd05044', 'PJCrinqdta17585',
    'DGGlennwoxr46018', 'DFDardadnbz59781', 'YYStaciarowk22321',
    'PGKelsivbor99897', 'SMKayleggjp10134', 'IZDarbiedfmr44305',
    'QRElvirafdpl08922', 'ZSBelitafvnt13381', 'RCFayreshdd87515',
    'PGTressaaygc09803', 'OBBillmukb52197', 'NGHalleybaki42419',
    'EAKaidnvy50941', 'MODoreycawq22301', 'XGZariahkfo78795',
    'GGMarinaydi01706', 'INMarionyupg02240', 'LGDagmarbnmx10476',
    'JPHolliiwka51031', 'XHImeldaseop48714', 'DMKatamtod05586',
    'LCGillytrvy99656', 'AHClariesqth90266', 'BGWinnasxkv81376',
    'JNSonnivpug52602', 'ATShaunatlzx45953', 'ZSMariamrcxm12249',
    'ICHazellwnr70528', 'WYMattydaug95468', 'HGRaynafdjo30645',
    'ICKailaccze74588', 'YJLeeanndxst71335', 'JGTobyeadqx08716',
    'JPMartiewlrz28619', 'NHAledaqbfo50711', 'YHMeirsvc00576',
    'XBNolieukfc18750', 'ZWMarielvec75668', 'DDAmandydjjr65169',
    'LHDannyemvty44264', 'YKElkeaojg17835', 'JNHettirohp68813',
    'XDMargiemkso89965', 'JWMufibxnw06375', 'ZWLiliavyhp75641',
    'HKCarolhatd58540', 'EILethiawppx37763', 'RZHalleyiyeh40523',
    'NIBrearydil06085', 'UBEmileekwuc14706', 'EIAltasmmt23782',
    'IOFelizafeok30109', 'OORasiaurpn14572', 'YKElaynecyhf12693',
    'EKGaegfoj51654', 'TKCorditylm57755', 'RIBerniekuvx99851',
    'BTLizzyumks31809', 'CSMaddiebekn81323', 'CHArletamktv21190',
    'YLReggieiebq64996', 'UBDellyhlvx96364', 'PQRasiaaqvc25293',
    'JAJanajzlu33179', 'IVRonninmqb14424', 'WPKippecuw17371',
    'ZBTonieeofh92401', 'ybjtkaqc4875', 'gznu23ozpr44', 'ikrxsovd1032',
    'jekcdqvr7540', 'hrwk30gqjc09', 'zzmw99tcby49', 'rexlpegt7997',
    'aasrfglh2551', 'uzydvvuh6870', 'asip32xcyu47', 'zjmb50atvg14',
    'oxabgvxq6390', 'cbfmrguo9810', 'akjw89exmf06', 'vzjscfmc4836',
    'efmm90aqnf91', 'jhrg90xogr16', 'dukp86ereo99', 'nknk31dycj02',
    'qtonsivp3418', 'yeczyott0432', 'swmbkfiy2882', 'ttgb00mrvv70',
    'pgyavylp8327', 'kpxcfvrg6166', 'puwh89owjk01', 'lpmuvmbh1227',
    'pdnv73ibhx66', 'ggug65vijo52', 'rdkdqhtt0983', 'nnahbtpa8385',
    'njoabpqk3206', 'mcob64kngf44', 'bvvz46zswk58', 'deuo02mndp47',
    'fjja50loen43', 'opbziscv8386', 'yiqj62grsg51', 'QOGinniecnnr94958',
    'RASharljszz02769', 'XBRickymrwy05462', 'UQKaligsyt07970',
    'EFAlisunwxwj18248', 'BNNoreneagtv57629', 'PJPerlwodw60063',
    'GUDollnpre48502', 'YDTatejldg60465', 'KUDaphnanyvo00114',
    'DFAbbigsur90670', 'HXShelbnxq71982', 'HUGianagmdp65371',
    'BDMadelkgng81236', 'GWJessebwpg03567', 'LYValinaipsp30660',
    'WHAdeyudnc51092', 'QAArabelmjrb61682', 'OYKatinezgio40488',
    'NNLaneytktu99599', 'WKMaggieotsp94321', 'VYRaheltbhp93311',
    'PBRhebazfnt48104', 'ICSophiehkhb15055', 'UFRenaetyim66660',
    'QDDorovjkv43102', 'AXQuinnlfai12426', 'GUEmilypecw12095',
    'IVEmilyuuth01042', 'URMargeeqdd70357', 'AFJaineuqph15261',
    'WVVioletbuuq46195', 'GNDebbiokpz49530', 'BEBrynargve97503',
    'NJZaraqlch42298', 'XYVikiysmg06526', 'XOZandrammnf05393', 'RLIdaqmqq11795',
    'UADehliafyjw33374', 'PGShereebedp88087', 'KIDarlazxwf76720',
    'ygoe70jgwr60', 'jqxmwiwj2539', 'lods23levs04', 'ffbkarti5845',
    'gzulmavu7241', 'kuee59xuqh43', 'vjxzvjkv1309', 'ophs46ydxm84',
    'nffsleji3375', 'khqovadf5464', 'fhky19dqyj68', 'qjkmehyt7972',
    'umuowhar5236', 'dtdobuqm6668', 'vwkhkwun4545', 'tbaw80bevm97',
    'ylfi13dcvx09', 'pdlz99wmbj37', 'ckgg20upfu02', 'fwan58hpfg17',
    'vxmh29hpub42', 'nxgl07ugjg49', 'jpvl81kper16', 'euuvodsa4001',
    'ngkd16brrp11', 'skstydsh1158', 'kphnzzxe5337', 'emtklrbg2330',
    'yyxi61uhbl52', 'mjkt14udgi82', 'bkcf95qido57', 'dxykuicz7602',
    'absx98hbww55', 'fwqr41zxud22', 'tajytxma7814', 'ljfo20mzix22',
    'htpfzqxv8996', 'girmyorl1955', 'JPShellilmhj55243', 'GAKoriecnsz07294',
    'YZUlrikezyxb40105', 'BGArliekztd63355', 'OZAlyssapzhz54041',
    'BWChickysold67645', 'FHGiselaouyq93845', 'SFCorirkzz72561',
    'VFCarrykaaa17424', 'TXBenitasdwl25405', 'DTCatezpci01504',
    'PIBillxisl21050', 'DKTallouvjuv90619', 'VYJaymeeoeec33500',
    'DBVenusqrux20507', 'AHRodinjuu49236', 'XUHanniefran60847',
    'KNMartarzmg33925', 'QYNissacakh58723', 'YQGeneepsg65681',
    'FBVerinaevxw24645', 'ZLReggiexywt05112', 'DKTamradjry12072',
    'EWHannisrdxd01555', 'KRBeawqus85030', 'DTKajakgny18129', 'OZKayceexm58984',
    'VXLottaotdr18771', 'ORVinadyoi11797', 'WOGlenhzun09075', 'OVToriegoy29535',
    'MAWendizesf72431', 'AGMoinaelvh87919', 'XKElizahwhu72191',
    'UDFlossiayfj37904', 'TEDonnalvvt15495', 'MXAubrypawx75831',
    'LEAngeltcxc76221', 'EMAniatied88089', 'TJPerialzqz37632',
    'GEMetadgkr58788', 'FHKaileyldyf10324', 'MBAlijbof11635', 'umlh43ltps32',
    'ozgvrglg6034', 'ofaixzpa7648', 'rxjy45osyh80', 'edxuruml7353',
    'mzbhpgvw9149', 'sxvuksxj6319', 'deqtqcnp6429', 'coyzcarj9521',
    'xblfueif9565', 'nxyg66vbwz09', 'cgpk13rsje12', 'nuzz94foif42',
    'muuiabko7280', 'tpzt04cdca58', 'zwue04mvvq35', 'vnhc21nvhm66',
    'urhq02dyfs07', 'fhkkblcg1621', 'alxp97fmsg56', 'iocqcqbr3411',
    'tigi28rfjq02', 'krwq68acod43', 'wbonyqvm5419', 'rgap40bnqk60',
    'heisqsth5988', 'exhg13fawt66', 'dutf70bvht34', 'fibo25hzeb89',
    'sijwrikm4307', 'mwrn04pdqb65', 'qwnd28pkmm79', 'pbmd07ljwu94',
    'pbcmasei5654', 'hserdbeu6311', 'pbhp81jdui39', 'wkrsxlmo0013',
    'oyeh77laid53', 'uwxr72tnmx09', 'brax11aano87', 'opdg79mpfx70',
    'hoilvlto8259', 'oqwh52goiq59', 'kxiu45yebc65', 'rlyc98qtse76',
    'fuee02pvaz09', 'magu66zhxd22', 'ufabgduf6394', 'ykdopgkm3671',
    'dnxv56jsem31', 'solm70zfvl04', 'hgbq04gcke55', 'qidr92bgbz15',
    'wqak06wvss34', 'onvtniaq8638', 'doiwqqyb0116', 'mwij02tino96',
    'njwkbxcl9609', 'uine11zfng84', 'pobv20cqya18', 'rtyv25xwtr24',
    'wchvfmhu6465', 'eocr10wwjz30', 'zimthnwl2447', 'wqmr77uwyg44',
    'qlbt74zohz64', 'rsmthqbh6242', 'pssp67yzxq83', 'znyndrxk8364',
    'xhvhhioh9265', 'ptxrkqpe7839', 'pqjqlwew2673', 'wzjmbigo9803',
    'ahwl86ofms08', 'rytr99irdi30', 'wzurklyv3312', 'sdsjbyow3151',
    'dfkw70pcxq74', 'oiyl33fnei85', 'WPTeraxgsf74960', 'AMGuiflcg57320',
    'KSIbbieefzp72984', 'GEJanelrauz11990', 'NGLivyakkw92843',
    'MYJanelavouz55943', 'LVRavenfeyx61552', 'UVChrisevrj11838',
    'RIDasixkaj54380', 'XNJillpjpi83849', 'GZStellapnib33530',
    'HDMarthaqdgr52452', 'WNCaricemf67468', 'ZMCaseythzb14068',
    'LMStephaqibp75217', 'UTPersisrykd63906', 'SAAynilrk83631',
    'DLIlyssawrdh90523', 'UOBinniefcoy71308', 'TCDeniceaunh20939',
    'MSMinaozjh37699', 'FETorieaama54817', 'KNGaylezmfh69528',
    'WRAubreyvqem23880', 'CKFlorrrfj93391', 'MCFlorielzon50903',
    'MQNonnahmkky86627', 'XZDodiezmda54926', 'CRCorrigtlq47437',
    'TFBeazkhf48558', 'NZVonniefmlh95621', 'YFMinnievhsg55703',
    'GKShandyebtl20926', 'MOWandieoeww45363', 'SEBonnyqmde59324',
    'OQDellysctt12801', 'PUArdrazaun77534', 'KFAlysasgsf08884',
    'OJKerrinxjgw77765', 'JEAmalleythq40229', 'HYAddiamowl08485',
    'MNDionezogv82564', 'IOEllenraeo92660', 'BPMargesryj28767',
    'DVLivqptu66111', 'WPAnnisqqss85043', 'RKLatiafzyr56757',
    'JRDaisiqyxw99301', 'PLGlennawnqo74446', 'WADrumazw80517',
    'DIRowenaquig89659', 'XCPhildlyj93833', 'QQKandyecsa71942',
    'DTLeannacyv77060', 'HBDamitammpo10913', 'AXKrissyojtj10056',
    'PJAlanahmfuo21876', 'GDEveevla46114', 'VPSianajhtn49794',
    'MEMabelezjw70416', 'JWAlleenjzav46352', 'TRAmandaycbm83362',
    'WIShaunayxuc22745', 'NWBeeiixz10847', 'REEmlynkgqb30183',
    'QRAerieltmiv25244', 'DUKateawdl87584', 'VKRandimwpy49714',
    'XDLoriedusu28137', 'YCFulviauhrm72088', 'RFOonavaph25851',
    'OLTeddyobrv01107', 'GJVelmawcew25256', 'TUJendawajy08439',
    'NULilithigku17843', 'RJBertatsjl52686', 'PHFelicezxon37402',
    'TPEvannepevh67813', 'BHFawnewssr63534', 'OKAnniswjyd06396',
    'HMAynbhis03166', 'UVOnidawimu48617', 'laifeiyg0132', 'jumg41ycvv46',
    'vapl47vhjm10', 'pleorljo9784', 'fcyrzrcp2894', 'ygfi46hgnl11',
    'wlpn75bzez49', 'tght12xvtg98', 'jtcn47qwwi39', 'xzcmwvvy0040',
    'ecooiyfw2162', 'szzvzmux6278', 'gaebuqfa1457', 'ncgxnvae9216',
    'oeeyslan6737', 'jdxf80seqk06', 'bton85pzqw89', 'bjqd54pesy62',
    'adnnzeyi1406', 'ozvvjyxo7373', 'oobo24lwrs22', 'eengppra2141',
    'pokigoli8618', 'xncbybmw8209', 'rguf01wjjw78', 'ggcj59txkm47',
    'viypwcpy5959', 'ecey25kmlo62', 'yqmy17nbka34', 'xnqn00nndy51',
    'ybzx58tdrq28', 'mzfu24gwjx70', 'qiutwbxb0514', 'sadw10bfol16',
    'mnwqtbuk3827', 'jsqafsxk9101', 'ffvsalcp0912', 'tepy77lzob72',
    'DHRenatanfkb45896', 'JIJennisqvz59755', 'RYElainavpjf71126',
    'LCLissizmfc79567', 'AXJosefaxenk28553', 'DQCammyepwo67455',
    'BGKacynisk77424', 'KBRannazbld44994', 'EMOlympehhdu68135',
    'DRRosiemvxg07017', 'NBDanahjdl66993', 'CQDorryiios69829',
    'UJRonicaxens90303', 'XJAndreillum71985', 'EUDebbiekhgu24747',
    'LFFarandxjvs46835', 'JZFrankyvrnx80029', 'JCBellmnym83305',
    'RGAmitieymrf62655', 'XVAnabelydon87989', 'QXDennaehwt41279',
    'JBGaynorqxfi79758', 'GPHerthafade84202', 'JUWindymoye99640',
    'SOStarlalnxw71310', 'BBZolavsup14469', 'WMFrankklkh59357',
    'SZNormacpkw28929', 'TDDoricegchu09939', 'JLLucinesktm51315',
    'KLEssiekanb70879', 'ADElysefbci67510', 'TCDennizabt51206',
    'EGTiffmmbf99777', 'XQLaurihjds20530', 'RFDrucievcln09908',
    'LCSalomixrnv91299', 'TJDavidalfnt89024', 'CJPeggygnqn45352',
    'XIAlicevfcw16940', 'KIDebradwwa00062', 'odrdzwzd8661', 'ldlm58sfjk76',
    'phnywone9973', 'mczehotb4664', 'rcpzgvde9298', 'qjkq28cgrc29',
    'ncselmnm2539', 'yikl14jrqo90', 'rzaj94mfcn48', 'vhxx30bllg23',
    'hvtl16gtiy41', 'ryitbsud1562', 'fynn04hkxa85', 'zblzuiqz2987',
    'irbeohgj0574', 'ajdbzppr0754', 'aich85mrog01', 'grys51egub07',
    'tanelqnn2765', 'xpbemnzk0607', 'clkj51czzk36', 'xtwhumhf6714',
    'rrum95xgmf54', 'ecfg23rlyx85', 'zkgnwrtd8642', 'sgfz06ycpw58',
    'tutmjhbe2270', 'chloffrl2551', 'gwfc20sfng35', 'aadm65zxpw96',
    'qnzg93ggxy32', 'jfjdchma4533', 'cqteqqka6766', 'jwyleqhi5662',
    'muqesfus3792', 'gkcd50jwkk36', 'hdzhotwd8810', 'ubht43ivgy97',
    'dggf11mcra72', 'uordwcde4038', 'fgnh52okhv78', 'nwqi74tjdh45',
    'ipji26mjed22', 'txts03ujow18', 'wzuw92ivwr11', 'qoftrqxk5536',
    'rkfv70swbq49', 'rehd19wmeu98', 'xhrjsgqy6093', 'tgwgpqml8059',
    'fhlnumea3709', 'abtlaolc5212', 'klsfszsi7918', 'nbhbvblf7202',
    'lbia48ceyd20', 'wwiyonts2428', 'vzgvyefe5575', 'qewz53mecc12',
    'kuanpown0259', 'kewt65ohvl42', 'kmxm91eonu93', 'ubzb81nqxi57',
    'iophyyqf7291', 'rjkx84unvg26', 'vzcrzdld2292', 'kezqdvjc9077',
    'pebm39wcnr54', 'idah89lbjq03', 'ltibsnhl6576', 'omdi32terv26',
    'lzxpsrzs6077', 'dztjkjxp3170', 'pjxz27jpxz18', 'xuzptvzb7134',
    'iarr23rctc27', 'qxss09dzot26', 'svzykfjv9842', 'ustdnrzu7417',
    'kykgwlhe7419', 'bbczjcph8180', 'jxeq40ujtl86', 'bujlqmyd7375',
    'fewprbba0333', 'cadmmtfe1112', 'bymr81ngkv47', 'tixuxqbq3205',
    'wlde08cwsg65', 'kgbqfpml4419', 'ccxj06ofbc21', 'czil67jnjc92',
    'zocg93wlzs05', 'jsmz32hqbj10', 'iswxbind3733', 'aifgztzm2273',
    'elcs58ioiw43', 'fjmf39dqev78', 'mzewvhdy0308', 'bjbu40xpue83',
    'lqvvidlg6099', 'djlg83gifz72', 'afcp34rovj47', 'vgpu62vpwf40',
    'sbcl01mrxz54', 'vbnb01efeh23', 'ewwvrxpv8810', 'jtczimsn1204',
    'ttbf01anvz12', 'vxockpkz9468', 'hfqbdzcw2887', 'isvqpghu2483',
    'prww19cfqw22', 'uzef57iycy22', 'abcz94rzwg31', 'wvqa45eaqn89',
    'ygft65harz48', 'mgnwaixz9759', 'tgegehgk0332', 'qlsi74lnzo32',
    'ayac05fjoc49', 'prfcrrlg2798', 'gwhy73zllo65', 'bhue41alof37',
    'pwvthtkv3455', 'ejef86tbhr85', 'zxhj19jgxc22', 'pakwhzvw7858',
    'icqg45cewt80', 'lsrkewwp6121', 'gsmy67gyai32', 'wbwr45xfzg59',
    'wjxs22iqki46', 'cxkr01qxyf46', 'wiylfjwn2865', 'ukyydzfl1035',
    'glpv54ysxj82', 'bnks77owld66', 'twsekiwj0853', 'vhmm70gmde93',
    'vexh68wufe37', 'zqnhrkzl5395', 'rwtufpva2647', 'deouposv6464',
    'jrqkltgn1833', 'globqcrd1131', 'sihpuhuu3555', 'ohhx43jjrh56',
    'fchi26rlcf98', 'wtabaajq9249', 'onxgzdtx4311', 'zjxk71sjvg04',
    'hauyljiz5392', 'chtfqbym9650', 'qifvlzyz7028', 'ubgg75zids81',
    'xmojnvoz5910', 'qqgf19jxkn72', 'xxeh97cxbs56', 'asnn60xsbv45',
    'makg93vzya43', 'aqrowxyn5285', 'xjhoyixc0795', 'qbcesyag2540',
    'icbwuikc1899', 'vbkwfinp9930', 'wtxh65ydez82', 'rekabhdo1476',
    'tgjxohjz2867', 'yvaa47udlc14', 'uoklagpu3154', 'emob38jfjw31',
    'xcpv36owna22', 'rmeuvbet7819', 'ieym78zjjn29', 'nranmkmm4782',
    'bockzsqv1214', 'nznddkxi2250', 'mmlqdrnl1401', 'ztpsczvf8449',
    'bilc12icsj30', 'lbxd37ofgx37', 'xbgilafi8068', 'zfai98ahwt34',
    'shqf84oidu73', 'ybve16wabz42', 'grgf47rkal60', 'qbsn51znaw49',
    'yrkk65gjad25', 'astcbskc9208', 'lafp03gpwy44', 'kvzl75edma78',
    'smfpekkn5388', 'rpgu21yyim36', 'vbup58dbrz09', 'kdruxwtu4924',
    'foat08hyuv21', 'imhpwqiy6850', 'CXCicelyrdsz09548', 'OMMargitncct66377',
    'RDSherriwcdp88349', 'OJAnettarzze05909', 'FPMarionyqfe56377',
    'JSEnidgiqj68204', 'JDTiffyukks38937', 'GDEmmawngw60197',
    'QBTerradtxr62661', 'VUAlidattvj32170', 'SGBennypxyl60250',
    'UKKimmietyma97435', 'EGNonnahnzvz61036', 'FMEstarcip41458',
    'KTAgaceobxn19408', 'FWAndreirjjf53579', 'WIJaclynjhea01590',
    'JLPollyawwt82696', 'JUEsmelkyw99329', 'OUDavitaysyt38756',
    'IESelavbrl48601', 'SVMaudeswfc02988', 'LLLenahbsr56531', 'TLRosatump48172',
    'HQMindytvvy36110', 'YMChandawznd21779', 'QYSheryefxzf64784',
    'MAAvieioat96505', 'MUCarenaleog21567', 'MGTinelrsu65692',
    'MIAmandyycxf37606', 'VZMinnacnqd32905', 'HEEllenjqtc18498',
    'CTShantapeac31917', 'KLJunehsjx70337', 'EOKaylynzgwr15186',
    'VURhodieimgh04571', 'JNBertacpw91734', 'JOCindajdtm27840',
    'GDRebekahzso56209', 'GSKariajbak89139', 'pfcdbgbj5475', 'rikluqrs0804',
    'qdux50etxe75', 'ajpfxsbw3139', 'kldmlmnh3512', 'qcqznzwk5837',
    'qqho40xccw01', 'lneb14oleu94', 'desvhfce8323', 'atffznwa2027',
    'arqi46ppvx72', 'hbyj86anpv32', 'bpqnfkdl2040', 'wmldhhcf6592',
    'mmlu75pdde73', 'hkuq66yyhg21', 'fjpv96vfft17', 'mwpkzfhw1002',
    'pjudjroj8591', 'abfuxcdj5864', 'cwns37ygyu11', 'obgf90dnur25',
    'njrz85tmlc94', 'eenymsku3518', 'mxzj03oklh62', 'mkbomjug3934',
    'blml38dkrb28', 'fzzsened6131', 'odxw39ychw19', 'dffb33okkm77',
    'zpkhdong8737', 'uujzsriz5880', 'igolkjwi8135', 'wuoq73ndjh38',
    'ndpg57gbsm92', 'xicxakph6457', 'zhsy83mnme15', 'yglpulxf6551',
    'iwpp50lvra72', 'tpkyvmnn0214', 'kljd93ltit66', 'nwynqszi0022',
    'dgll77qawc79', 'aeqn96zuea57', 'bnnv78asni31', 'suikvtcg9450',
    'kmudnroj0635', 'hmdfsnlb9398', 'osrzdegp1756', 'jzcqbpmt2377',
    'ybngtesk1260', 'zponyqza3598', 'iifo17sfto24', 'kkpv91royk28',
    'vfrs16kvap22', 'xbyd82xojg46', 'wkvp52weru85', 'sirl34kbbt72',
    'cagz23gubg09', 'jexuupzy6867', 'webp22nouu79', 'uqwgmszs1265',
    'mscy62jncb99', 'toyo88qjhn11', 'ynjg77zbyz47', 'olvo09mgie68',
    'nrxtzesb2816', 'dvqs23noxx72', 'chjw80srcd75', 'hsrrytqv7233',
    'ifuszfgy3464', 'gixrysuy7236', 'xgeryrml5489', 'gbmuchuq2722',
    'anbf12tdns70', 'gnvg79kzvq56', 'oxkfyibb8425', 'wlki27kgil17',
    'fbiolpbk7700', 'isbo54owes73', 'mkdw94oczy23', 'nxvijdvh6225',
    'fmrn74akut33', 'lyof51devl22', 'byip86wqly52', 'pbpwtsjp7472',
    'grsj27cugt86', 'mcnl58fbck65', 'uoxgmhqr8424', 'dxdz40hewm80',
    'soegkbxa5984', 'wjwmfbnu5562', 'gvlt28xhyq74', 'yncd80lojm75',
    'dvkb14zpvw58', 'kmrgzfna7095', 'vlug13gjct09', 'xoou09fzix83',
    'agytgsaa4325', 'fjofphtf5713', 'wqwf93bxex61', 'nxvo34wtzt02',
    'rxsu63jpib77', 'ijhlbucu9903', 'eusj08npva14', 'ovnriopt0054',
    'fjecsxou8731', 'rbcn33hbng73', 'kckq58jwwz55', 'ifsmtpdt9673',
    'vkfeapxi4232', 'icfh31tqvv78', 'tqxq48hiwd66', 'kzltewja3372',
    'idbf52krgf52', 'vlvsbrcf3000', 'qlipndri7634', 'yhayjmtt5055',
    'nkzskpyr7007', 'wdddmeio3531', 'jobh61evvm26', 'lecaubko6174',
    'lhbutewz0140', 'fkwy00bkgt24', 'feqisjyx3419', 'jzjetkvk0667',
    'emrr16jleb24', 'fatejayy6238', 'kndlelsl9954', 'qrxsmbpi8379',
    'hjgr97lhre13', 'mkjhuqnt9190', 'albdpcvj8914', 'ljxb08arcl18',
    'zxxnsfnf4959', 'svsnowhs9802', 'kgigpvat8401', 'nnjj95lwtc36',
    'dwdp02glzf70', 'hhkbyteb1002', 'gpee86wcaa34', 'zsfo18erto50',
    'tlqm68ffeo29', 'vlqg46fsyg67', 'kktt05piul70', 'jjyq25euut01',
    'azav49vylg80', 'dogk71rydz00', 'cwvp91sjdi09', 'jecjubie8200',
    'grdn11dryp48', 'ueptnkfx9067', 'rkyw76vmlq83', 'xvthzcfi5213',
    'nrxxmpfj9432', 'bacp53hjih04', 'ovip08czel55', 'htpmsftq8671',
    'urzu25apqx06', 'tzsofcxf2892', 'dntz52rmfk59', 'ioer02iscw39',
    'mdujttgb2644', 'isqswswq1436', 'jcabggyc2974', 'raal45hnxr53',
    'jlel48vslz10', 'ilda72knra37', 'elea57utci26', 'qwcd68xuwp26',
    'hmsn76lmow14', 'rwkf57cvrp60', 'awui66avpt33', 'jetbxivm1616',
    'yyrj48gned76', 'eufljmob8680', 'zqgueicf5045', 'ktpl55oqxs73',
    'bdnfcabp2388', 'mnss56ymkv48', 'ebxuuhnq8050', 'vpckexvn3753',
    'pxrjrrvr0084', 'tzcs27aagn53', 'tyhj08uzew73', 'lweh88bkqk24',
    'eyapuqyl3547', 'fmjb73ryrv53', 'silp11fiqy26', 'npbalmsz6403',
    'izfvxcbl8775', 'zbxextiu6757', 'qsyk97gdzi76', 'czep64tjln00',
    'tjauxdhu7402', 'eayiggjn7261', 'giwv39fqhu78', 'ovqn83oska13',
    'yhnp24ypvn18', 'RQSonnieqsgs00279', 'EENellidsmr41673', 'UGDarivekq10431',
    'RPNanciemsub03994', 'QZAmargovugp35031', 'WGErichaabut91819',
    'HGSelinevryt12070', 'SERhondamtml89504', 'DRLuisejcuq66827',
    'XALorinettzn68970', 'CSSalomakyct17520', 'ICAloiseruxr72259',
    'PACarinaeuxp34493', 'NBValidabsej41378', 'INDollswtw03400',
    'SWKatlinehqs10169', 'PQBeilulmsqr54083', 'JEColliesiuz86421',
    'SYDayleiruw90370', 'GWAudryecwiu62251', 'QGGussihwus54737',
    'YCAmargowwce01082', 'AVDamitawlwa34653', 'IMGildahlnb41592',
    'GJMarlavpax59022', 'ULKittighjk13670', 'QGSammyfmta85121',
    'BDMaggeedvex57992', 'WROlenkahbue50835', 'ADRenniejuaw12450',
    'VVFanniemkiw87142', 'YAAndeepzhf68196', 'JYOrelleojis14713',
    'GHDennitpbw89405', 'PLOralleuhsa35670', 'QODavetaqdem41849',
    'QMLottyjmey24851', 'KYMinnisgmr54716', 'AIDottiejqgj97838',
    'BNJewellpioe13024', 'KCMarcieayux98851'
}
local RECEIVER_LIST = {
    'drdnoasn1760', 'grxyrrna0315', 'BMDawnavjwv25431', 'JLSonnivafh94777',
    'MWAnetteuzkc65711', 'XYTeddiemfjx63637', 'VFDinnymacz08327',
    'CRTinenmjf39106', 'RISibealgojn71413', 'XPBrigitaizy23639',
    'YOBobbiuvfu30239', 'LYLyssafazq65999', 'tkswwbrt8803', 'vwrlasdl7968',
    'ygiw76wtck58', 'fpal29uodw30', 'VKDevihk04658', 'ZLDevinifcp55032',
    'FETrishjkqn72957', 'YCEnricanoht44097', 'vzan40jgnj80', 'mmilbfci2791',
    'CZKirbeeumzc32476', 'VWTamrayvxw37767', 'DTAlexiahneq37984',
    'QOPatsyjrli31613', 'RSJobinajuze73484', 'LWIlysaipwr90404',
    'RLAdianaikpf62624', 'BAJeannauiej29737', 'CQRhetaltsx80616',
    'XEZsazsacylh78645', 'RLCarovotj23253', 'LWCordieydai04068', 'lvkpjwmh9901',
    'wjrf07whkv74', 'VECodieaxjq01722', 'OAAllaxexw42608', 'THKaylerytn62191',
    'OADulcyxvcf73234', 'yghb33omjz93', 'mvax27avaq72', 'ymawfgth9376',
    'crnr80qgcl84', 'xgfy62gkhb53', 'mykwjfar9201', 'wvfb94hqyd85',
    'yhfd96xzra23', 'OVAllxueca29552', 'JGReynaqzof21673', 'GQStarlapons02634',
    'STarynrfq35437', 'ylppwzbf3924', 'jhcqagba8727', 'hvzzsqkm5678',
    'qkss74oise65', 'xqkwtxag5219', 'lphcykro0682', 'kooo70fveb42',
    'pnuf49nzfp80', 'nbvwtyqz6612', 'dssmruyq4742', 'apai81reel09',
    'cagyzzjr2280', 'TZJolipoyt60197', 'VJHeddarajw90937', 'BKRomyytqj00791',
    'OQStefaybyo74179', 'kmiimshl9564', 'warq49pdwl34', 'TFAarenuxvb16582',
    'JTAmabeltlas45386', 'gnpoimio5819', 'vbxc40hsmd25', 'QUMaviswbvm58097',
    'OQTraciodcg60483', 'idrj62rihb22', 'ecsz26atdp79', 'alkt45yvdm98',
    'jacd61csyb75', 'VOEvaoxqq40030', 'QEDyannemysn86307', 'DFNatkagtkq04652',
    'UMNoelkkjx20098', 'jdxawncy9675', 'dvzg83zubi28', 'FMDiansjkp61158',
    'IJDarynuvbr98821', 'mpnb09tdxn22', 'inernkll9536', 'pfsj56lxdc79',
    'geuv46sfjn64', 'vlaaxxmw5146', 'mfpp56zphp07', 'eepxcyiu3780',
    'ftuwzyzc8613', 'wrdo05xdfo90', 'pcqz90gbiw46', 'IYSelallgk62333',
    'BPDulciehjej66530', 'wyer35vuxg41', 'cyri76zwbj83', 'tiwu12ncfo51',
    'uqol83avhi52', 'uxgfzhub3309', 'oscfqfhg1881', 'cidf48hlft37',
    'ehxv63urpf64', 'tkzj56qkma71', 'mnprwyxv3461', 'PXReganlmka76233',
    'AKBuffyhfjy55576'
}

-- ตัวแปรสำหรับการทำงาน
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local GuiService = game:GetService("GuiService")
local VirtualInputManager = game:GetService("VirtualInputManager")

-- ตัวแปรสำหรับ tracking
local currentStep = 0
local currentStepReceiver = 0 -- ตัวแปรแยกสำหรับ receiver mode
local isTrading = false
local tradePartner = nil

-- ตัวแปรสำหรับตรวจสอบสถานะการเพิ่มไอเทม
local shroomAdded = false
local tokenAdded = false
local creatureAdded = false

-- ตัวแปรควบคุมการเรียก remote (ป้องกันการเรียกซ้อน)
local isRemoteBusy = false
local lastRemoteCallTime = 0

-- ตัวแปรสำหรับ state-based tracking (เพิ่มใหม่)
local receiverCreatureStartTime = 0
local receiverCreatureRequested = false
local receiverAcceptStartTime = 0
local receiverAcceptRequested = false

-- ตัวแปรสำหรับ receiver timeout (เพิ่มใหม่)
local lastTradeRequestTime = tick()
local RECEIVER_TIMEOUT = 300 -- 5 นาที (300 วินาที)

-- ตัวแปรสำหรับ sender state-based tracking
local senderShroomStartTime = 0
local senderShroomRequested = false
local senderTokenStartTime = 0
local senderTokenRequested = false
local senderCreatureStartTime = 0
local senderCreatureRequested = false
local senderAcceptStartTime = 0
local senderAcceptRequested = false

-- ตัวแปรป้องกันการทำงานพร้อมกัน
local isSenderMainActive = false
local isSenderReceiverActive = false

-- ตัวแปรสำหรับ timeout การรอเริ่มเทรดหลังส่งคำขอหา receiver
local SENDER_REQUEST_TIMEOUT = 200 -- วินาที
local lastSentTargetName = nil
local lastSentTargetIsReceiver = false
local lastSentTime = 0

-- ฟังก์ชันช่วยเหลือ
local function IsInList(name, list)
    for _, listName in ipairs(list) do
        if name == listName then return true end
    end
    return false
end

local function Clicked_Ui(path)
    local success, error =
        pcall(function() GuiService.SelectedObject = path end)

    if not success then
        warn(
            "❌ เกิดข้อผิดพลาดในการเลือก UI: " ..
                tostring(error))
    end
end

local function Click_NOW()
    local success, error = pcall(function()
        VirtualInputManager:SendKeyEvent(true, 13, false, game)
        wait(0.1)
        VirtualInputManager:SendKeyEvent(false, 13, false, game)
        task.wait(2)
        Clicked_Ui(nil)
    end)

    if not success then
        warn(
            "❌ เกิดข้อผิดพลาดในการกดปุ่ม: " ..
                tostring(error))
    end
end

-- ฟังก์ชันวาร์ปไปยังตำแหน่งที่กำหนด
local function WarpToLocation()
    local targetPosition = Vector3.new(-2132.24, 490.66, 1106.83)
    local tolerance = 5 -- ระยะห่างที่ยอมรับได้ (studs)
    
    while true do
        local success, error = pcall(function()
            local character = LocalPlayer.Character
            if character and character:FindFirstChild("HumanoidRootPart") then
                local currentPosition = character.HumanoidRootPart.Position
                local distance = (currentPosition - targetPosition).Magnitude
                
                -- เช็คว่าอยู่ใกล้ตำแหน่งเป้าหมายหรือยัง
                if distance <= tolerance then
                    -- อยู่ที่ตำแหน่งแล้ว ไม่ต้องวาร์ป
                    return
                end
                
                -- ยังไม่ถึงตำแหน่ง วาร์ปไป
                character:PivotTo(CFrame.new(targetPosition))
                print("✅ วาร์ปไปยังตำแหน่งที่กำหนดแล้ว (ระยะห่าง: " .. math.floor(distance) .. " studs)")
            end
        end)

        if not success then
            warn(
                "❌ เกิดข้อผิดพลาดในการวาร์ป: " ..
                    tostring(error))
        end
        task.wait(5)
    end
end

-- ฟังก์ชันหาคู่เทรดที่ว่าง
local function FindValidReceiver()
    local result = nil
    local success, error = pcall(function()
        -- ตรวจสอบ coins ก่อน
        local coinsValue = LocalPlayer.Data.Coins.Value
        if coinsValue <= 20 then
            print("💰 Coins ไม่เพียงพอ (" .. coinsValue ..
                      " <= 20) ไม่ทำการเทรด")
            return nil
        end

        print(
            "🔍 กำลังค้นหาคู่เทรดที่ว่าง...")

        -- ค้นหา receiver ที่ว่าง
        local validReceivers = {}
        local getPlayersSuccess = pcall(function()
            for _, player in pairs(Players:GetPlayers()) do
                if IsInList(player.Name, RECEIVER_LIST) then
                    local isAvailable = false
                    local tradingValue = nil
                    local checkSuccess = pcall(function()
                        if player and player:FindFirstChild("Settings") and
                            player.Settings:FindFirstChild("Trading") then
                            tradingValue = player.Settings.Trading.Value
                            isAvailable = (tradingValue == false)
                        else
                            isAvailable = true
                            tradingValue = "unknown"
                        end
                    end)

                    if not checkSuccess then
                        print(
                            "⚠️ เกิดข้อผิดพลาดในการเช็คสถานะ " ..
                                player.Name ..
                                " สมมติว่าว่าง...")
                        isAvailable = true
                        tradingValue = "error"
                    end

                    if isAvailable then
                        print("✅ พบ receiver ที่ว่าง: " ..
                                  player.Name .. " (Trading.Value = " ..
                                  tostring(tradingValue) .. ")")
                        table.insert(validReceivers, player)
                    else
                        print("❌ Receiver " .. player.Name ..
                                  " กำลังเทรดอยู่ (Trading.Value = " ..
                                  tostring(tradingValue) .. ")")
                    end
                end
            end
        end)

        if not getPlayersSuccess then
            print(
                "❌ เกิดข้อผิดพลาดในการดึงรายชื่อผู้เล่น")
            return nil
        end

        -- ถ้ามี receiver ว่าง ให้เลือกหนึ่งคน
        if #validReceivers > 0 then
            local selected = validReceivers[math.random(1, #validReceivers)]
            print("🎯 เลือก receiver: " .. selected.Name)
            result = selected
            return
        end

        -- ถ้าไม่มี receiver ว่าง ให้ค้นหา sender อื่นที่ว่าง
        print(
            "ไม่มี receiver ว่าง กำลังค้นหา sender อื่น...")
        local validSenders = {}
        for _, player in pairs(Players:GetPlayers()) do
            if IsInList(player.Name, SENDER_LIST) and player.Name ~=
                LocalPlayer.Name then
                local isAvailable = false
                local tradingValue = nil
                pcall(function()
                    tradingValue = player.Settings.Trading.Value
                    isAvailable = (tradingValue == false)
                end)

                if isAvailable then
                    print("✅ พบ sender ที่ว่าง: " ..
                              player.Name .. " (Trading.Value = " ..
                              tostring(tradingValue) .. ")")
                    table.insert(validSenders, player)
                else
                    print("❌ Sender " .. player.Name ..
                              " กำลังเทรดอยู่ (Trading.Value = " ..
                              tostring(tradingValue) .. ")")
                end
            end
        end

        if #validSenders > 0 then
            local selected = validSenders[math.random(1, #validSenders)]
            print(
                "🎯 เลือก sender เพื่อเทรดด้วย: " ..
                    selected.Name)
            result = selected
            return
        end

        print("❌ ไม่พบคู่เทรดที่ว่าง")
    end)
    if not success then
        warn(
            "❌ เกิดข้อผิดพลาดในฟังก์ชัน FindValidReceiver: " ..
                tostring(error))
    end
    return result
end

-- ฟังก์ชันส่ง trade request
local function SendTradeRequest(receiverName)
    local success, error = pcall(function()
        local args = {
            "SendRequest", game:GetService("Players"):WaitForChild(receiverName)
        }
        game:GetService("Players").LocalPlayer:WaitForChild("Remotes")
            :WaitForChild("TradeRequestRemote"):FireServer(unpack(args))
        print("📤 ส่ง trade request ไปยัง " .. receiverName)
    end)

    if not success then
        warn(
            "❌ เกิดข้อผิดพลาดในการส่ง trade request: " ..
                tostring(error))
        return false
    end

    return true
end

-- ฟังก์ชันหาผู้เล่น sender ที่ว่าง (ค้นหาเฉพาะ sender)
local function FindAvailableSender()
    local result = nil
    local success, error = pcall(function()
        print(
            "🔍 กำลังค้นหา sender ที่ว่าง...")

        local validSenders = {}
        for _, player in pairs(Players:GetPlayers()) do
            if IsInList(player.Name, SENDER_LIST) and player.Name ~=
                LocalPlayer.Name then
                local isAvailable = false
                local tradingValue = nil
                pcall(function()
                    if player and player:FindFirstChild("Settings") and
                        player.Settings:FindFirstChild("Trading") then
                        tradingValue = player.Settings.Trading.Value
                        isAvailable = (tradingValue == false)
                    else
                        isAvailable = true
                        tradingValue = "unknown"
                    end
                end)

                if isAvailable then
                    print("✅ พบ sender ที่ว่าง: " ..
                              player.Name .. " (Trading.Value = " ..
                              tostring(tradingValue) .. ")")
                    table.insert(validSenders, player)
                else
                    print("❌ Sender " .. player.Name ..
                              " กำลังเทรดอยู่ (Trading.Value = " ..
                              tostring(tradingValue) .. ")")
                end
            end
        end

        if #validSenders > 0 then
            local selected = validSenders[math.random(1, #validSenders)]
            print("🎯 เลือก sender: " .. selected.Name)
            result = selected
            return
        end

        print("❌ ไม่พบ sender ที่ว่าง")
    end)
    if not success then
        warn(
            "❌ เกิดข้อผิดพลาดในฟังก์ชัน FindAvailableSender: " ..
                tostring(error))
    end
    return result
end

-- ฟังก์ชัน add shroom
local function AddShroom()
    local tradeGuiSafe = LocalPlayer.PlayerGui and
                             LocalPlayer.PlayerGui:FindFirstChild("TradeGui")
    if not (tradeGuiSafe and tradeGuiSafe.Enabled) then
        print("❌ TradeGui ไม่เปิดใช้งาน")
        return false
    end

    local success, error = pcall(function()
        -- ตรวจสอบ coins ก่อน
        local coinsValue = LocalPlayer.Data.Coins.Value
        if coinsValue <= 20 then
            print("💰 Coins ไม่เพียงพอ (" .. coinsValue ..
                      " <= 20) ไม่สามารถเพิ่ม shroom ได้")
            return false
        end

        local tradeGui = LocalPlayer.PlayerGui.TradeGui
        local containerFrame = tradeGui.ContainerFrame
        local theirsFrame = containerFrame.Theirs
        local displayNameLabel = theirsFrame.DisplayNameLabel
        local userNameLabel = displayNameLabel.UserNameLabel
        local opponentName = userNameLabel.Text

        opponentName = opponentName:gsub("@", "")
        local localPlayerName = LocalPlayer.Name

        local amount = coinsValue - 20
        if amount > 500000 then amount = 500000 end
        if amount < 0 then amount = 0 end

        local args = {
            "AddTradeItem",
            {
                Overwrite = true,
                ItemType = "Currency",
                Name = "Shooms",
                Amount = amount
            }
        }

        if not LocalPlayer.PlayerGui.TradeGui.Enabled then
            print(
                "❌ TradeGui ถูกปิดระหว่าง AddShroom, reset currentStep")
            currentStep = 0
            return false
        end

        local remote1Name = localPlayerName .. "-" .. opponentName ..
                                "TradeRemote"
        local remote1 = ReplicatedStorage:FindFirstChild("Remotes") and
                            ReplicatedStorage.Remotes:FindFirstChild(remote1Name)
        if not remote1 then
            print("❌ ไม่พบ remote1: " .. tostring(remote1Name))
            currentStep = 0
            return false
        end
        remote1:InvokeServer(unpack(args))
        print("⏳ รอ 3 วินาทีหลังใช้ remote1...")
        wait(3)

        local remote2Name = opponentName .. "-" .. localPlayerName ..
                                "TradeRemote"
        local remote2 = ReplicatedStorage:FindFirstChild("Remotes") and
                            ReplicatedStorage.Remotes:FindFirstChild(remote2Name)
        if not remote2 then
            print("❌ ไม่พบ remote2: " .. tostring(remote2Name))
            currentStep = 0
            return false
        end
        remote2:InvokeServer(unpack(args))
        print("⏳ รอ 3 วินาทีหลังใช้ remote2...")
        wait(3)

        print("✅ เพิ่ม " .. amount ..
                  " Shrooms ในการเทรดกับ " ..
                  opponentName)
        return true
    end)

    if not success then
        warn(
            "❌ เกิดข้อผิดพลาดในฟังก์ชัน AddShroom: " ..
                tostring(error))
        currentStep = 0
        return false
    end

    return true
end

-- ฟังก์ชัน add token
local function AddToken()
    local tradeGuiSafe = LocalPlayer.PlayerGui and
                             LocalPlayer.PlayerGui:FindFirstChild("TradeGui")
    if not (tradeGuiSafe and tradeGuiSafe.Enabled) then
        print("❌ TradeGui ไม่เปิดใช้งาน")
        return false
    end

    -- ตรวจสอบว่า remote กำลังใช้งานอยู่หรือไม่
    if isRemoteBusy then
        print(
            "⚠️ Remote กำลังใช้งานอยู่ รอสักครู่...")
        return false
    end

    local tokenList = {
        'ChangeCreatureColorsToken', 'CreatureReviveToken', 'FullGrowToken',
        'PartialGrowToken', 'FreeSpinToken', 'RandomStoredCreatureToken',
        'DeathGachaToken'
    }

    local success, error = pcall(function()
        local tradeGui = LocalPlayer.PlayerGui.TradeGui
        local containerFrame = tradeGui.ContainerFrame
        local theirsFrame = containerFrame.Theirs
        local displayNameLabel = theirsFrame.DisplayNameLabel
        local userNameLabel = displayNameLabel.UserNameLabel
        local opponentName = userNameLabel.Text

        opponentName = opponentName:gsub('@', '')
        local localPlayerName = LocalPlayer.Name

        -- ตั้งค่า remote กำลังใช้งาน
        isRemoteBusy = true

        for i, tokenName in ipairs(tokenList) do
            if not LocalPlayer.PlayerGui.TradeGui.Enabled then
                print(
                    "❌ TradeGui ถูกปิดระหว่าง AddToken, reset currentStep")
                isRemoteBusy = false
                currentStep = 0
                return false
            end

            local args = {
                'AddTradeItem',
                {
                    Overwrite = true,
                    ItemType = 'Tokens',
                    Name = tokenName,
                    Amount = 150
                }
            }

            local remoteName = localPlayerName .. '-' .. opponentName ..
                                   'TradeRemote'
            local remote = ReplicatedStorage:FindFirstChild('Remotes') and
                               ReplicatedStorage.Remotes:FindFirstChild(
                                   remoteName)
            if not remote then
                print('❌ ไม่พบ remote: ' .. tostring(remoteName))
                isRemoteBusy = false
                currentStep = 0
                return false
            end

            print("📤 กำลังเพิ่ม " .. tokenName .. " (" ..
                      i .. "/" .. #tokenList .. ")...")

            local remoteSuccess, remoteError = pcall(function()
                remote:InvokeServer(unpack(args))
            end)

            if not remoteSuccess then
                warn(
                    "❌ เกิดข้อผิดพลาดในการเรียก remote สำหรับ " ..
                        tokenName .. ": " .. tostring(remoteError))
                isRemoteBusy = false
                currentStep = 0
                return false
            end

            print('✅ เพิ่ม ' .. tokenName ..
                      ' ในการเทรดกับ ' .. opponentName)

            -- รอ 3 วินาทีหลังใช้ remote
            print(
                "⏳ รอ 3 วินาทีหลังใช้ remote สำหรับ " ..
                    tokenName .. "...")
            wait(3)
        end

        -- ปลดล็อค remote
        isRemoteBusy = false
        print(
            '✅ เพิ่ม token ทั้งหมดเสร็จสิ้น')
        return true
    end)

    if not success then
        warn(
            "❌ เกิดข้อผิดพลาดในฟังก์ชัน AddToken: " ..
                tostring(error))
        isRemoteBusy = false
        currentStep = 0
        return false
    end

    return true
end

-- ฟังก์ชัน add creature สำหรับ Receiver แบบปลอดภัย
local function AddCreatureReceiver()
    local tradeGuiSafe = LocalPlayer.PlayerGui and
                             LocalPlayer.PlayerGui:FindFirstChild("TradeGui")
    if not (tradeGuiSafe and tradeGuiSafe.Enabled) then
        print("❌ TradeGui ไม่เปิดใช้งาน")
        return false
    end

    -- ตรวจสอบว่า remote กำลังใช้งานอยู่หรือไม่
    if isRemoteBusy then
        print(
            "⚠️ Remote กำลังใช้งานอยู่ รอสักครู่...")
        return false
    end

    local success, error = pcall(function()
        local Unlocks = LocalPlayer.Data and LocalPlayer.Data.Unlocks
        local creatureName = nil

        if LocalPlayer and LocalPlayer.Data and LocalPlayer.Data.Unlocks then
            for _, child in pairs(Unlocks:GetChildren()) do
                if not LocalPlayer.PlayerGui.TradeGui.Enabled then
                    print(
                        '❌ TradeGui ถูกปิดระหว่าง AddCreatureReceiver, reset currentStep')
                    currentStepReceiver = 0
                    return false
                end
                if child:IsA('ValueBase') and tonumber(child.Value) and
                    tonumber(child.Value) > 0 then
                    if child.Name ~= "Vin'rou" and child.Name ~= 'Eulopii' then
                        creatureName = child.Name
                        break
                    end
                end
            end

            if not creatureName then
                warn(
                    '❌ ไม่พบ creature ที่ตรงเงื่อนไข')
                currentStepReceiver = 0
                return false
            end

            local theirLabel = LocalPlayer.PlayerGui and
                                   LocalPlayer.PlayerGui:FindFirstChild(
                                       'TradeGui') and
                                   LocalPlayer.PlayerGui.TradeGui.ContainerFrame
                                       .Theirs.DisplayNameLabel.UserNameLabel

            if not theirLabel or not theirLabel.Text then
                warn(
                    '❌ ไม่พบชื่อฝ่ายตรงข้าม')
                currentStepReceiver = 0
                return false
            end

            local otherPlayerName = theirLabel.Text
            if string.sub(otherPlayerName, 1, 1) == '@' then
                otherPlayerName = string.sub(otherPlayerName, 2)
            end

            local remoteName = otherPlayerName .. '-' .. LocalPlayer.Name ..
                                   'TradeRemote'
            local remotes = ReplicatedStorage:FindFirstChild('Remotes')
            if not remotes then
                print('❌ ไม่พบ Remotes folder')
                currentStepReceiver = 0
                return false
            end

            local remote = remotes:FindFirstChild(remoteName)
            if not remote then
                print('❌ ไม่พบ remote: ' .. tostring(remoteName))
                currentStepReceiver = 0
                return false
            end

            if not LocalPlayer.PlayerGui.TradeGui.Enabled then
                print(
                    '❌ TradeGui ถูกปิดระหว่าง AddCreatureReceiver, reset currentStep')
                currentStepReceiver = 0
                return false
            end

            -- ตรวจสอบเวลาที่ผ่านไปตั้งแต่ remote call ล่าสุด
            local timeSinceLastCall = tick() - lastRemoteCallTime
            if timeSinceLastCall < 3 then
                local waitTime = 3 - timeSinceLastCall
                print("⏳ รอ " .. string.format("%.1f", waitTime) ..
                          " วินาทีก่อนเรียก remote สำหรับ creature...")
                wait(waitTime)
            end

            -- ตั้งค่า remote กำลังใช้งาน
            isRemoteBusy = true
            lastRemoteCallTime = tick()

            local args = {
                'AddTradeItem',
                {
                    Overwrite = true,
                    ItemType = 'Creatures',
                    Name = creatureName,
                    Amount = 1
                }
            }

            print("📤 กำลังเพิ่ม creature: " ..
                      creatureName .. "...")

            local remoteSuccess, remoteError = pcall(function()
                remote:InvokeServer(unpack(args))
            end)

            if not remoteSuccess then
                warn(
                    '❌ เกิดข้อผิดพลาดในการเรียก Remote: ' ..
                        tostring(remoteError))
                isRemoteBusy = false
                currentStepReceiver = 0
                return false
            else
                print('✅ เพิ่ม creature สำเร็จ!')
                lastRemoteCallTime = tick()

                -- รอ 3 วินาทีหลังใช้ remote
                print(
                    "⏳ รอ 3 วินาทีหลังใช้ remote สำหรับ creature...")
                wait(3)

                -- ปลดล็อค remote
                isRemoteBusy = false
                return true
            end
        else
            print(
                '❌ ไม่สามารถเข้าถึง Data.Unlocks ได้')
            currentStepReceiver = 0
            return false
        end
    end)

    if not success then
        warn(
            '❌ เกิดข้อผิดพลาดในฟังก์ชัน AddCreatureReceiver: ' ..
                tostring(error))
        isRemoteBusy = false
        currentStepReceiver = 0
        return false
    end

    return true
end

-- ฟังก์ชัน add creature
local function AddCreature(isReceiver)
    local tradeGuiSafe = LocalPlayer.PlayerGui and
                             LocalPlayer.PlayerGui:FindFirstChild("TradeGui")
    if not (tradeGuiSafe and tradeGuiSafe.Enabled) then
        print("❌ TradeGui ไม่เปิดใช้งาน")
        return false
    end

    -- ตรวจสอบว่า remote กำลังใช้งานอยู่หรือไม่
    if isRemoteBusy then
        print(
            "⚠️ Remote กำลังใช้งานอยู่ รอสักครู่...")
        return false
    end

    local success, error = pcall(function()
        local Unlocks = LocalPlayer.Data and LocalPlayer.Data.Unlocks
        local creatureName = nil

        if LocalPlayer and LocalPlayer.Data and LocalPlayer.Data.Unlocks then
            for _, child in pairs(Unlocks:GetChildren()) do
                if not LocalPlayer.PlayerGui.TradeGui.Enabled then
                    print(
                        '❌ TradeGui ถูกปิดระหว่าง AddCreature, reset currentStep')
                    currentStep = 0
                    return false
                end
                if child:IsA('ValueBase') and tonumber(child.Value) and
                    tonumber(child.Value) > 0 then
                    if child.Name ~= "Vin'rou" and child.Name ~= 'Eulopii' then
                        creatureName = child.Name
                        break
                    end
                end
            end

            if not creatureName then
                warn(
                    '❌ ไม่พบ creature ที่ตรงเงื่อนไข')
                currentStep = 0
                return false
            end

            local theirLabel = LocalPlayer.PlayerGui and
                                   LocalPlayer.PlayerGui:FindFirstChild(
                                       'TradeGui') and
                                   LocalPlayer.PlayerGui.TradeGui.ContainerFrame
                                       .Theirs.DisplayNameLabel.UserNameLabel

            if not theirLabel or not theirLabel.Text then
                warn(
                    '❌ ไม่พบชื่อฝ่ายตรงข้าม')
                currentStep = 0
                return false
            end

            local otherPlayerName = theirLabel.Text
            if string.sub(otherPlayerName, 1, 1) == '@' then
                otherPlayerName = string.sub(otherPlayerName, 2)
            end

            local remoteName
            if isReceiver then
                remoteName = otherPlayerName .. '-' .. LocalPlayer.Name ..
                                 'TradeRemote'
            else
                remoteName = LocalPlayer.Name .. '-' .. otherPlayerName ..
                                 'TradeRemote'
            end
            local remote = ReplicatedStorage:FindFirstChild('Remotes') and
                               ReplicatedStorage.Remotes:FindFirstChild(
                                   remoteName)
            if not remote then
                print('❌ ไม่พบ remote: ' .. tostring(remoteName))
                currentStep = 0
                return false
            end

            if not LocalPlayer.PlayerGui.TradeGui.Enabled then
                print(
                    '❌ TradeGui ถูกปิดระหว่าง AddCreature, reset currentStep')
                currentStep = 0
                return false
            end

            -- ตรวจสอบเวลาที่ผ่านไปตั้งแต่ remote call ล่าสุด
            local timeSinceLastCall = tick() - lastRemoteCallTime
            if timeSinceLastCall < 3 then
                local waitTime = 3 - timeSinceLastCall
                print("⏳ รอ " .. string.format("%.1f", waitTime) ..
                          " วินาทีก่อนเรียก remote สำหรับ creature...")
                wait(waitTime)
            end

            -- ตั้งค่า remote กำลังใช้งาน
            isRemoteBusy = true
            lastRemoteCallTime = tick()

            local args = {
                'AddTradeItem',
                {
                    Overwrite = true,
                    ItemType = 'Creatures',
                    Name = creatureName,
                    Amount = 1
                }
            }

            print("📤 กำลังเพิ่ม creature: " ..
                      creatureName .. "...")

            local remoteSuccess, remoteError = pcall(function()
                remote:InvokeServer(unpack(args))
            end)

            if not remoteSuccess then
                warn(
                    '❌ เกิดข้อผิดพลาดในการเรียก Remote: ' ..
                        tostring(remoteError))
                isRemoteBusy = false
                currentStep = 0
                return false
            else
                print('✅ เพิ่ม creature สำเร็จ!')
                lastRemoteCallTime = tick()

                -- รอ 3 วินาทีหลังใช้ remote
                print(
                    "⏳ รอ 3 วินาทีหลังใช้ remote สำหรับ creature...")
                wait(3)

                -- ปลดล็อค remote
                isRemoteBusy = false
                return true
            end
        else
            print(
                '❌ ไม่สามารถเข้าถึง Data.Unlocks ได้')
            currentStep = 0
            return false
        end
    end)

    if not success then
        warn(
            '❌ เกิดข้อผิดพลาดในฟังก์ชัน AddCreature: ' ..
                tostring(error))
        isRemoteBusy = false
        currentStep = 0
        return false
    end

    return true
end

-- ฟังก์ชันกด accept สำหรับ Receiver แบบปลอดภัย
local function ClickAcceptReceiver()
    local success, error = pcall(function()
        if not LocalPlayer.PlayerGui.TradeGui.Enabled then
            print("❌ TradeGui ไม่เปิดใช้งาน")
            return false
        end

        -- ตรวจสอบว่า remote กำลังใช้งานอยู่หรือไม่
        if isRemoteBusy then
            print(
                "⚠️ Remote ยังใช้งานอยู่ ไม่สามารถกด accept ได้!")
            return false
        end

        local tradeGui = LocalPlayer.PlayerGui:FindFirstChild("TradeGui")
        if not tradeGui then
            print("❌ ไม่พบ TradeGui")
            return false
        end

        local containerFrame = tradeGui:FindFirstChild("ContainerFrame")
        if not containerFrame then
            print("❌ ไม่พบ ContainerFrame")
            return false
        end

        local acceptButton = containerFrame:FindFirstChild("AcceptButton")
        if not acceptButton then
            print("❌ ไม่พบ AcceptButton")
            return false
        end

        local upperLabel = acceptButton:FindFirstChild("UpperLabel")
        if not upperLabel then
            print("❌ ไม่พบ UpperLabel")
            return false
        end

        Clicked_Ui(upperLabel)
        task.wait(.1)
        Click_NOW()
        print("✅ กด accept แล้ว")
        return true
    end)

    if not success then
        warn(
            "❌ เกิดข้อผิดพลาดในการกด accept: " ..
                tostring(error))
        return false
    end

    return true
end

-- ฟังก์ชันกด accept
local function ClickAccept()
    local success, error = pcall(function()
        if not LocalPlayer.PlayerGui.TradeGui.Enabled then
            print("❌ TradeGui ไม่เปิดใช้งาน")
            return false
        end

        -- ตรวจสอบว่า remote กำลังใช้งานอยู่หรือไม่
        if isRemoteBusy then
            print(
                "⚠️ Remote ยังใช้งานอยู่ ไม่สามารถกด accept ได้!")
            return false
        end

        Clicked_Ui(LocalPlayer.PlayerGui.TradeGui.ContainerFrame.AcceptButton
                       .UpperLabel)
        task.wait(.1)
        Click_NOW()
        print("✅ กด accept แล้ว")
        return true
    end)

    if not success then
        warn(
            "❌ เกิดข้อผิดพลาดในการกด accept: " ..
                tostring(error))
        return false
    end

    return true
end

-- ฟังก์ชันกด cancel
local function ClickCancel()
    local success, error = pcall(function()
        Clicked_Ui(LocalPlayer.PlayerGui.TradeGui.ContainerFrame.CancelButton
                       .UpperLabel)
        task.wait(.1)
        Click_NOW()
        print("❌ ยกเลิกการเทรด")
    end)

    if not success then
        warn(
            "❌ เกิดข้อผิดพลาดในการกด cancel: " ..
                tostring(error))
    end
end

-- ฟังก์ชันเช็คชื่อคู่เทรด
local function CheckTradePartner()
    local success, error = pcall(function()
        if not LocalPlayer.PlayerGui.TradeGui.Enabled then return false end

        local theirLabel = LocalPlayer.PlayerGui.TradeGui.ContainerFrame.Theirs
                               .DisplayNameLabel.UserNameLabel
        if not theirLabel or not theirLabel.Text then return false end

        local opponentName = theirLabel.Text:gsub("@", "")

        -- เช็คว่าชื่อตรงกับในรายชื่อหรือไม่
        if IsInList(opponentName, RECEIVER_LIST) or
            IsInList(opponentName, SENDER_LIST) then
            print(
                "✅ ชื่อคู่เทรดถูกต้อง: " ..
                    opponentName)
            return true
        else
            print(
                "❌ ชื่อคู่เทรดไม่ตรงกับรายชื่อ: " ..
                    opponentName)
            ClickCancel()
            return false
        end
    end)

    if not success then
        warn(
            "❌ เกิดข้อผิดพลาดในการเช็คชื่อคู่เทรด: " ..
                tostring(error))
        return false
    end

    return true
end

-- ฟังก์ชัน accept trade request สำหรับ Sender
local function AcceptTradeRequestForSender()
    local success, error = pcall(function()
        local requestsGui = LocalPlayer.PlayerGui:FindFirstChild('RequestsGui')
        if not requestsGui then return false end

        local requestsFrame = requestsGui:FindFirstChild('RequestsFrame')
        if not requestsFrame then return false end

        local mobileFrame = requestsFrame:FindFirstChild('Mobile')
        if mobileFrame then
            for _, child in pairs(mobileFrame:GetChildren()) do
                if string.find(child.Name, "^Trade") then
                    local senderName = child.Name:sub(6) -- ตัด "Trade" ออก
                    -- Sender สามารถรับ trade request จาก sender อื่นได้
                    if IsInList(senderName, SENDER_LIST) then
                        print(
                            "✅ Sender พบ trade request แบบ Mobile จาก " ..
                                senderName .. " กำลัง accept...")

                        -- อัปเดตเวลาสุดท้ายที่ได้รับ trade request (เพิ่มใหม่)
                        lastTradeRequestTime = tick()

                        Clicked_Ui(child.AcceptButton.UpperLabel)
                        task.wait(.1)
                        Click_NOW()
                        return true
                    else
                        print("❌ Trade request แบบ Mobile จาก " ..
                                  senderName ..
                                  " ไม่ตรงกับรายชื่อ กำลัง decline...")
                        Clicked_Ui(child.DeclineButton.UpperLabel)
                        task.wait(.1)
                        Click_NOW()
                    end
                end
            end
        end

        local otherFrame = requestsFrame:FindFirstChild('Other')
        if not otherFrame then return false end

        for _, child in pairs(otherFrame:GetChildren()) do
            if string.find(child.Name, "^Trade") then
                local senderName = child.Name:sub(6) -- ตัด "Trade" ออก
                -- Sender สามารถรับ trade request จาก sender อื่นได้
                if IsInList(senderName, SENDER_LIST) then
                    print(
                        "✅ Sender พบ trade request แบบ Other จาก " ..
                            senderName .. " กำลัง accept...")

                    -- อัปเดตเวลาสุดท้ายที่ได้รับ trade request (เพิ่มใหม่)
                    lastTradeRequestTime = tick()

                    Clicked_Ui(child.AcceptButton.UpperLabel)
                    task.wait(.1)
                    Click_NOW()
                    return true
                else
                    print("❌ Trade request จาก " .. senderName ..
                              " ไม่ตรงกับรายชื่อ กำลัง decline...")
                    Clicked_Ui(child.DeclineButton.UpperLabel)
                    task.wait(.1)
                    Click_NOW()
                end
            end
        end

        return false
    end)

    if not success then
        warn(
            "❌ เกิดข้อผิดพลาดในการ accept trade request สำหรับ Sender: " ..
                tostring(error))
        return false
    end

    return true
end

-- ฟังก์ชัน accept trade request สำหรับ Receiver แบบปลอดภัย
local function AcceptTradeRequestReceiver()
    local success, error = pcall(function()
        local requestsGui = LocalPlayer.PlayerGui:FindFirstChild('RequestsGui')
        if not requestsGui then return false end

        local requestsFrame = requestsGui:FindFirstChild('RequestsFrame')
        if not requestsFrame then return false end

        local mobileFrame = requestsFrame:FindFirstChild('Mobile')
        if mobileFrame then
            for _, child in pairs(mobileFrame:GetChildren()) do
                if string.find(child.Name, "^Trade") then
                    local senderName = child.Name:sub(6) -- ตัด "Trade" ออก
                    if IsInList(senderName, SENDER_LIST) then
                        print(
                            "✅ Receiver พบ trade request แบบ Mobile จาก " ..
                                senderName .. " กำลัง accept...")

                        -- อัปเดตเวลาสุดท้ายที่ได้รับ trade request (เพิ่มใหม่)
                        lastTradeRequestTime = tick()

                        Clicked_Ui(child.AcceptButton.UpperLabel)
                        task.wait(.1)
                        Click_NOW()
                        return true
                    else
                        print("❌ Trade request แบบ Mobile จาก " ..
                                  senderName ..
                                  " ไม่ตรงกับรายชื่อ กำลัง decline...")
                        Clicked_Ui(child.DeclineButton.UpperLabel)
                        task.wait(.1)
                        Click_NOW()
                    end
                end
            end
        end

        local otherFrame = requestsFrame:FindFirstChild('Other')
        if not otherFrame then return false end

        for _, child in pairs(otherFrame:GetChildren()) do
            if string.find(child.Name, "^Trade") then
                local senderName = child.Name:sub(6) -- ตัด "Trade" ออก
                if IsInList(senderName, SENDER_LIST) then
                    print(
                        "✅ Receiver พบ trade request แบบ Other จาก " ..
                            senderName .. " กำลัง accept...")

                    -- อัปเดตเวลาสุดท้ายที่ได้รับ trade request (เพิ่มใหม่)
                    lastTradeRequestTime = tick()

                    Clicked_Ui(child.AcceptButton.UpperLabel)
                    task.wait(.1)
                    Click_NOW()
                    return true
                else
                    print("❌ Trade request จาก " .. senderName ..
                              " ไม่ตรงกับรายชื่อ กำลัง decline...")
                    Clicked_Ui(child.DeclineButton.UpperLabel)
                    task.wait(.1)
                    Click_NOW()
                end
            end
        end

        return false
    end)

    if not success then
        warn(
            "❌ เกิดข้อผิดพลาดในการ accept trade request สำหรับ Receiver: " ..
                tostring(error))
        return false
    end

    return true
end

-- ฟังก์ชัน accept trade request สำหรับ Receiver
local function AcceptTradeRequest()
    local success, error = pcall(function()
        local requestsGui = LocalPlayer.PlayerGui:FindFirstChild('RequestsGui')
        if not requestsGui then return false end

        local requestsFrame = requestsGui:FindFirstChild('RequestsFrame')
        if not requestsFrame then return false end

        local mobileFrame = requestsFrame:FindFirstChild('Mobile')
        if mobileFrame then
            for _, child in pairs(mobileFrame:GetChildren()) do
                if string.find(child.Name, "^Trade") then
                    local senderName = child.Name:sub(6) -- ตัด "Trade" ออก
                    if IsInList(senderName, SENDER_LIST) then
                        print(
                            "✅ Receiver พบ trade request แบบ Mobile จาก " ..
                                senderName .. " กำลัง accept...")

                        -- อัปเดตเวลาสุดท้ายที่ได้รับ trade request (เพิ่มใหม่)
                        lastTradeRequestTime = tick()

                        Clicked_Ui(child.AcceptButton.UpperLabel)
                        task.wait(.1)
                        Click_NOW()
                        return true
                    else
                        print("❌ Trade request แบบ Mobile จาก " ..
                                  senderName ..
                                  " ไม่ตรงกับรายชื่อ กำลัง decline...")
                        Clicked_Ui(child.DeclineButton.UpperLabel)
                        task.wait(.1)
                        Click_NOW()
                    end
                end
            end
        end

        local otherFrame = requestsFrame:FindFirstChild('Other')
        if not otherFrame then return false end

        for _, child in pairs(otherFrame:GetChildren()) do
            if string.find(child.Name, "^Trade") then
                local senderName = child.Name:sub(6) -- ตัด "Trade" ออก
                if IsInList(senderName, SENDER_LIST) then
                    print(
                        "✅ Receiver พบ trade request แบบ Other จาก " ..
                            senderName .. " กำลัง accept...")

                    -- อัปเดตเวลาสุดท้ายที่ได้รับ trade request (เพิ่มใหม่)
                    lastTradeRequestTime = tick()

                    Clicked_Ui(child.AcceptButton.UpperLabel)
                    task.wait(.1)
                    Click_NOW()
                    return true
                else
                    print("❌ Trade request จาก " .. senderName ..
                              " ไม่ตรงกับรายชื่อ กำลัง decline...")
                    Clicked_Ui(child.DeclineButton.UpperLabel)
                    task.wait(.1)
                    Click_NOW()
                end
            end
        end

        return false
    end)

    if not success then
        warn(
            "❌ เกิดข้อผิดพลาดในการ accept trade request สำหรับ Receiver: " ..
                tostring(error))
        return false
    end

    return true
end

-- ฟังก์ชัน Coroutine สำหรับ Sender ที่รับ trade request
local function SenderReceiverCoroutine()
    while true do
        local success, error = pcall(function()
            -- ตรวจสอบ coins ก่อน
            local coinsValue = LocalPlayer.Data.Coins.Value
            if coinsValue <= 20 then
                print("💰 Coins ไม่เพียงพอ (" ..
                          coinsValue ..
                          " <= 20) SenderReceiver ไม่ทำงาน")
                wait(10) -- รอ 10 วินาทีก่อนตรวจสอบใหม่
                return
            end

            if not LocalPlayer.PlayerGui.TradeGui.Enabled then
                -- รอ trade request
                AcceptTradeRequestForSender()

                -- ตรวจสอบ timeout สำหรับ Sender ที่ทำงานแบบ Receiver (เพิ่มใหม่)
                local timeSinceLastRequest = tick() - lastTradeRequestTime
                local timeRemaining = RECEIVER_TIMEOUT - timeSinceLastRequest

                if timeSinceLastRequest >= RECEIVER_TIMEOUT then
                    print(
                        "⚠️ Sender (Receiver mode) ไม่ได้รับ trade request นาน " ..
                            string.format("%.1f", timeSinceLastRequest) ..
                            " วินาที (เกิน " ..
                            RECEIVER_TIMEOUT .. " วินาที)")
                    print(
                        "🔄 กำลังเปลี่ยนเซิร์ฟเวอร์เพื่อหาคู่เทรดใหม่...")

                    local success, error = pcall(function()
                        local TeleportService = game:GetService(
                                                    "TeleportService")
                        TeleportService:Teleport(14119723130)
                    end)

                    if not success then
                        warn(
                            "❌ เกิดข้อผิดพลาดในการเปลี่ยนเซิร์ฟเวอร์: " ..
                                tostring(error))
                        print(
                            "🚪 กำลังออกจากเกม...")
                        game:Shutdown()
                    end
                    return
                else
                    -- แสดงสถานะเวลาที่เหลือทุก 30 วินาที
                    if math.floor(timeSinceLastRequest) % 30 == 0 or
                        timeRemaining <= 60 then
                        print(
                            "⏰ Sender (Receiver mode) รอ trade request... เหลือเวลาอีก " ..
                                string.format("%.0f", timeRemaining) ..
                                " วินาทีก่อนเปลี่ยนเซิร์ฟเวอร์")
                    end
                end

                -- รีเซ็ตสถานะเมื่อไม่ได้เทรด
                receiverCreatureStartTime = 0
                receiverCreatureRequested = false
                receiverAcceptStartTime = 0
                receiverAcceptRequested = false
                currentStepReceiver = 0
                isSenderReceiverActive = false
                wait(2)
            else
                -- กำลังเทรดอยู่ (เมื่อเป็น receiver)
                -- ตรวจสอบว่ามี trade request หรือไม่
                local hasTradeRequest = false
                local requestsFrame = LocalPlayer.PlayerGui.RequestsGui
                                          .RequestsFrame.Other
                if requestsFrame then
                    for _, child in pairs(requestsFrame:GetChildren()) do
                        if string.find(child.Name, "^Trade") then
                            hasTradeRequest = true
                            break
                        end
                    end
                end

                -- ถ้ามี trade request ให้ override main sender
                if hasTradeRequest then
                    print(
                        "📩 พบ trade request กำลัง override Main Sender...")
                    isSenderMainActive = false
                end

                -- ตรวจสอบว่า main sender loop กำลังทำงานอยู่หรือไม่
                if isSenderMainActive then
                    print(
                        "⏸️ Main Sender กำลังทำงานอยู่ SenderReceiver รอสักครู่...")
                    wait(1)
                    return
                end

                if currentStepReceiver == 0 then
                    -- เช็คชื่อคู่เทรดก่อน
                    if CheckTradePartner() then
                        isSenderReceiverActive = true
                        currentStepReceiver = 1
                        print(
                            "🚀 Sender เริ่มขั้นตอนที่ 1: Add Creature (โหมด Receiver)")
                    else
                        wait(1)
                    end
                elseif currentStepReceiver == 1 then
                    -- Add Creature - ใช้ state-based tracking
                    if not receiverCreatureRequested then
                        -- ตรวจสอบว่า remote กำลังใช้งานอยู่หรือไม่
                        if isRemoteBusy then
                            print(
                                "⏳ Remote กำลังใช้งานอยู่ รอสักครู่...")
                            wait(1)
                        else
                            print("🚀 เริ่ม Add Creature...")
                            -- เริ่มทำ AddCreature แบบไม่รอผลลัพธ์
                            spawn(function()
                                AddCreature(true)
                            end)
                            receiverCreatureRequested = true
                            receiverCreatureStartTime = tick()
                            print(
                                "⏳ รอให้ Add Creature เสร็จ...")
                        end
                    else
                        -- ตรวจสอบว่าผ่านไป 5 วินาทีแล้วหรือยัง
                        local elapsedTime = tick() - receiverCreatureStartTime
                        if elapsedTime >= 5 then
                            currentStepReceiver = 2
                            print(
                                "   Sender เริ่มขั้นตอนที่ 2: Click Accept (โหมด Receiver)")
                        else
                            print(
                                "⏳ รอ Add Creature เสร็จ... (" ..
                                    string.format("%.1f", 5 - elapsedTime) ..
                                    " วินาที)")
                        end
                    end
                elseif currentStepReceiver == 2 then
                    -- Click Accept - ใช้ state-based tracking
                    if not receiverAcceptRequested then
                        print("🚀 เริ่ม Click Accept...")
                        -- เริ่มทำ ClickAccept แบบไม่รอผลลัพธ์
                        spawn(function() ClickAccept() end)
                        receiverAcceptRequested = true
                        receiverAcceptStartTime = tick()
                        print(
                            "⏳ รอให้ Click Accept เสร็จ...")
                    else
                        -- ตรวจสอบว่าผ่านไป 3 วินาทีแล้วหรือยัง
                        local elapsedTime = tick() - receiverAcceptStartTime
                        if elapsedTime >= 3 then
                            currentStepReceiver = 0
                            print(
                                "✅ Sender เทรดเสร็จสิ้น (โหมด Receiver)")
                            -- รีเซ็ตสถานะ
                            receiverCreatureStartTime = 0
                            receiverCreatureRequested = false
                            receiverAcceptStartTime = 0
                            receiverAcceptRequested = false
                            isSenderReceiverActive = false
                        else
                            print(
                                "⏳ รอ Click Accept เสร็จ... (" ..
                                    string.format("%.1f", 3 - elapsedTime) ..
                                    " วินาที)")
                        end
                    end
                end
                wait(1)
            end
        end)

        if not success then
            warn(
                "❌ เกิดข้อผิดพลาดใน SenderReceiverCoroutine: " ..
                    tostring(error))
            currentStepReceiver = 0
            -- รีเซ็ตสถานะ
            receiverCreatureStartTime = 0
            receiverCreatureRequested = false
            receiverAcceptStartTime = 0
            receiverAcceptRequested = false
            isSenderReceiverActive = false
            wait(5) -- รอ 5 วินาทีก่อนลองใหม่
        end
    end
end

function TradeStepHandlerSender(step)
    if not LocalPlayer.PlayerGui.TradeGui.Enabled then
        -- ยังไม่ได้เทรด
        if step ~= 0 then
            print(
                "Trade ถูกยกเลิกหรือจบกลางคัน กำลัง reset step...")
            -- รีเซ็ตสถานะการเพิ่มไอเทม
            shroomAdded = false
            tokenAdded = false
            creatureAdded = false
            -- รีเซ็ตสถานะ sender tracking
            senderShroomStartTime = 0
            senderShroomRequested = false
            senderTokenStartTime = 0
            senderTokenRequested = false
            senderCreatureStartTime = 0
            senderCreatureRequested = false
            senderAcceptStartTime = 0
            senderAcceptRequested = false
            isSenderMainActive = false
            -- รีเซ็ตสถานะการส่งคำขอค้าง
            lastSentTargetName = nil
            lastSentTargetIsReceiver = false
            lastSentTime = 0
            step = 0
        end

        -- ตรวจสอบว่า SenderReceiver กำลังทำงานอยู่หรือไม่
        if isSenderReceiverActive then
            print(
                "⏸️ SenderReceiver กำลังทำงานอยู่ Main Sender รอสักครู่...")
            return 0
        end

        -- ตรวจสอบ coins ก่อน
        local coinsValue = LocalPlayer.Data.Coins.Value
        if coinsValue <= 20 then
            print("💰 Coins ไม่เพียงพอ (" .. coinsValue ..
                      " <= 20) ไม่ทำการเทรด")
            -- ถ้า coins ไม่เพียงพอ ให้ปลดล็อค main sender และรอ
            isSenderMainActive = false
            wait(10) -- รอ 10 วินาทีก่อนตรวจสอบใหม่
        else
            -- ถ้าส่งหา receiver ค้างไว้นานเกินกำหนด ให้ลองหา sender ที่ว่างแทน
            if lastSentTargetIsReceiver and lastSentTime > 0 then
                local elapsed = tick() - lastSentTime
                if elapsed >= SENDER_REQUEST_TIMEOUT then
                    print(
                        "⚠️ รอเริ่มเทรดกับ receiver (" ..
                            tostring(lastSentTargetName) ..
                            ") นานเกิน " .. SENDER_REQUEST_TIMEOUT ..
                            " วินาที กำลังหา sender แทน...")
                    local fallbackSender = FindAvailableSender()
                    if fallbackSender then
                        SendTradeRequest(fallbackSender.Name)
                        lastSentTargetName = fallbackSender.Name
                        lastSentTargetIsReceiver = false
                        lastSentTime = tick()
                        return 0
                    else
                        -- ปรับเวลาเพื่อหลีกเลี่ยงการ spam ตรวจซ้ำทันที
                        lastSentTime = tick()
                    end
                end
            end

            local validPartner = FindValidReceiver()
            if validPartner then
                SendTradeRequest(validPartner.Name)
                -- บันทึกสถานะเป้าหมายล่าสุดที่ส่งคำขอ
                lastSentTargetName = validPartner.Name
                lastSentTargetIsReceiver =
                    IsInList(validPartner.Name, RECEIVER_LIST)
                lastSentTime = tick()
            else
                -- ถ้าไม่มี partner ให้ปลดล็อค main sender
                isSenderMainActive = false
            end
        end
        return 0 -- reset step
    else
        -- กำลังเทรดอยู่
        -- เคลียร์สถานะการส่งคำขอค้างเมื่อเข้าสู่หน้าต่าง Trade จริง
        lastSentTargetName = nil
        lastSentTargetIsReceiver = false
        lastSentTime = 0
        if step == 0 then
            if CheckTradePartner() then
                print(
                    "🚀 เริ่มขั้นตอนที่ 1: Add Shroom")
                -- รีเซ็ตสถานะการเพิ่มไอเทมเมื่อเริ่มเทรดใหม่
                shroomAdded = false
                tokenAdded = false
                creatureAdded = false
                -- รีเซ็ตสถานะ sender tracking
                senderShroomStartTime = 0
                senderShroomRequested = false
                senderTokenStartTime = 0
                senderTokenRequested = false
                senderCreatureStartTime = 0
                senderCreatureRequested = false
                senderAcceptStartTime = 0
                senderAcceptRequested = false
                return 1
            end
        elseif step == 1 then
            if not LocalPlayer.PlayerGui.TradeGui.Enabled then
                print(
                    "TradeGui ถูกปิดระหว่าง AddShroom, reset step")
                return 0
            end
            -- Add Shroom - ใช้ state-based tracking
            if not senderShroomRequested then
                -- ตรวจสอบว่า remote กำลังใช้งานอยู่หรือไม่
                if isRemoteBusy then
                    print(
                        "⏳ Remote กำลังใช้งานอยู่ รอสักครู่...")
                    return 1
                else
                    print("🚀 เริ่ม Add Shroom...")
                    senderShroomRequested = true
                    senderShroomStartTime = tick()
                    isSenderMainActive = true -- ตั้ง active เมื่อเริ่มเทรดจริง
                    -- เรียก AddShroom แบบ synchronous และหยุด loop
                    print(
                        "⏸️ หยุด loop เพื่อรอ Add Shroom เสร็จ...")
                    local shroomSuccess = AddShroom()
                    if shroomSuccess then
                        shroomAdded = true
                        print("✅ Add Shroom เสร็จสิ้น")
                        print(
                            "🚀 เริ่มขั้นตอนที่ 2: Add Token")
                        return 2
                    else
                        print("❌ Add Shroom ล้มเหลว")
                        senderShroomRequested = false
                        isSenderMainActive = false
                        return 0
                    end
                end
            else
                -- ถ้า shroom ยังไม่เสร็จ แต่เวลาผ่านไปมากเกินไป
                local elapsedTime = tick() - senderShroomStartTime
                if elapsedTime >= 10 then
                    print(
                        "⚠️ Add Shroom ใช้เวลานานเกินไป กำลังข้ามไป step 2")
                    shroomAdded = true
                    return 2
                else
                    print("⏳ รอ Add Shroom เสร็จ... (" ..
                              string.format("%.1f", 10 - elapsedTime) ..
                              " วินาที)")
                    return 1
                end
            end
        elseif step == 2 then
            if not LocalPlayer.PlayerGui.TradeGui.Enabled then
                print(
                    "TradeGui ถูกปิดระหว่าง AddToken, reset step")
                return 0
            end
            -- Add Token - ใช้ state-based tracking
            if not senderTokenRequested then
                -- ตรวจสอบว่า remote กำลังใช้งานอยู่หรือไม่
                if isRemoteBusy then
                    print(
                        "⏳ Remote กำลังใช้งานอยู่ รอสักครู่...")
                    return 2
                else
                    print("🚀 เริ่ม Add Token...")
                    senderTokenRequested = true
                    senderTokenStartTime = tick()
                    -- เรียก AddToken แบบ synchronous และหยุด loop
                    print(
                        "⏸️ หยุด loop เพื่อรอ Add Token เสร็จ...")
                    local tokenSuccess = AddToken()
                    if tokenSuccess then
                        tokenAdded = true
                        print("✅ Add Token เสร็จสิ้น")
                        print(
                            "🚀 เริ่มขั้นตอนที่ 3: Add Creature")
                        return 3
                    else
                        print("❌ Add Token ล้มเหลว")
                        senderTokenRequested = false
                        return 0
                    end
                end
            else
                -- ถ้า token ยังไม่เสร็จ แต่เวลาผ่านไปมากเกินไป
                local elapsedTime = tick() - senderTokenStartTime
                if elapsedTime >= 30 then
                    print(
                        "⚠️ Add Token ใช้เวลานานเกินไป กำลังข้ามไป step 3")
                    tokenAdded = true
                    return 3
                else
                    print("⏳ รอ Add Token เสร็จ... (" ..
                              string.format("%.1f", 30 - elapsedTime) ..
                              " วินาที)")
                    return 2
                end
            end
        elseif step == 3 then
            if not LocalPlayer.PlayerGui.TradeGui.Enabled then
                print(
                    "TradeGui ถูกปิดระหว่าง AddCreature, reset step")
                return 0
            end
            -- Add Creature - ใช้ state-based tracking
            if not senderCreatureRequested then
                -- ตรวจสอบว่า remote กำลังใช้งานอยู่หรือไม่
                if isRemoteBusy then
                    print(
                        "⏳ Remote กำลังใช้งานอยู่ รอสักครู่...")
                    return 3
                else
                    print("🚀 เริ่ม Add Creature...")
                    senderCreatureRequested = true
                    senderCreatureStartTime = tick()
                    -- เรียก AddCreature แบบ synchronous และหยุด loop
                    print(
                        "⏸️ หยุด loop เพื่อรอ Add Creature เสร็จ...")
                    local creatureSuccess = AddCreature(false)
                    if creatureSuccess then
                        creatureAdded = true
                        print("✅ Add Creature เสร็จสิ้น")
                        print(
                            "🚀 เริ่มขั้นตอนที่ 4: Click Accept")
                        return 4
                    else
                        print("❌ Add Creature ล้มเหลว")
                        senderCreatureRequested = false
                        return 0
                    end
                end
            else
                -- ถ้า creature ยังไม่เสร็จ แต่เวลาผ่านไปมากเกินไป
                local elapsedTime = tick() - senderCreatureStartTime
                if elapsedTime >= 10 then
                    print(
                        "⚠️ Add Creature ใช้เวลานานเกินไป กำลังข้ามไป step 4")
                    creatureAdded = true
                    return 4
                else
                    print("⏳ รอ Add Creature เสร็จ... (" ..
                              string.format("%.1f", 10 - elapsedTime) ..
                              " วินาที)")
                    return 3
                end
            end
        elseif step == 4 then
            if not LocalPlayer.PlayerGui.TradeGui.Enabled then
                print(
                    "TradeGui ถูกปิดระหว่าง ClickAccept, reset step")
                return 0
            end
            -- Click Accept - ใช้ state-based tracking
            if not senderAcceptRequested then
                -- ตรวจสอบว่าทุกขั้นตอนเสร็จสิ้นแล้ว
                if shroomAdded and tokenAdded and creatureAdded then
                    print(
                        "🔍 ตรวจสอบสถานะ: Shroom=" ..
                            tostring(shroomAdded) .. ", Token=" ..
                            tostring(tokenAdded) .. ", Creature=" ..
                            tostring(creatureAdded))

                    -- ตรวจสอบว่า remote ยังใช้งานอยู่หรือไม่
                    if isRemoteBusy then
                        print(
                            "⚠️ Remote ยังใช้งานอยู่ ไม่สามารถกด accept ได้! รอสักครู่...")
                        return 4 -- ยังคงอยู่ใน step 4
                    end
                    print("🚀 เริ่ม Click Accept...")
                    senderAcceptRequested = true
                    senderAcceptStartTime = tick()
                    -- เรียก ClickAccept แบบ synchronous และหยุด loop
                    print(
                        "⏸️ หยุด loop เพื่อรอ Click Accept เสร็จ...")
                    local acceptSuccess = ClickAccept()
                    if acceptSuccess then
                        print("✅ เทรดเสร็จสิ้น")
                        -- รีเซ็ตสถานะการเพิ่มไอเทม
                        shroomAdded = false
                        tokenAdded = false
                        creatureAdded = false
                        -- รีเซ็ตสถานะ sender tracking
                        senderShroomStartTime = 0
                        senderShroomRequested = false
                        senderTokenStartTime = 0
                        senderTokenRequested = false
                        senderCreatureStartTime = 0
                        senderCreatureRequested = false
                        senderAcceptStartTime = 0
                        senderAcceptRequested = false
                        isSenderMainActive = false
                        return 0
                    else
                        print("❌ Click Accept ล้มเหลว")
                        senderAcceptRequested = false
                        return 0
                    end
                else
                    print(
                        "⚠️ ยังมีขั้นตอนที่ยังไม่เสร็จ: Shroom=" ..
                            tostring(shroomAdded) .. ", Token=" ..
                            tostring(tokenAdded) .. ", Creature=" ..
                            tostring(creatureAdded))
                    -- กลับไปทำขั้นตอนที่ยังไม่เสร็จ
                    if not shroomAdded then
                        print("🔄 กลับไปทำ Add Shroom")
                        return 1
                    elseif not tokenAdded then
                        print("🔄 กลับไปทำ Add Token")
                        return 2
                    elseif not creatureAdded then
                        print("🔄 กลับไปทำ Add Creature")
                        return 3
                    end
                end
            else
                -- ถ้า accept ยังไม่เสร็จ แต่เวลาผ่านไปมากเกินไป
                local elapsedTime = tick() - senderAcceptStartTime
                if elapsedTime >= 5 then
                    print(
                        "⚠️ Click Accept ใช้เวลานานเกินไป กำลังจบเทรด")
                    print("✅ เทรดเสร็จสิ้น")
                    -- รีเซ็ตสถานะการเพิ่มไอเทม
                    shroomAdded = false
                    tokenAdded = false
                    creatureAdded = false
                    -- รีเซ็ตสถานะ sender tracking
                    senderShroomStartTime = 0
                    senderShroomRequested = false
                    senderTokenStartTime = 0
                    senderTokenRequested = false
                    senderCreatureStartTime = 0
                    senderCreatureRequested = false
                    senderAcceptStartTime = 0
                    senderAcceptRequested = false
                    isSenderMainActive = false
                    return 0
                else
                    print("⏳ รอ Click Accept เสร็จ... (" ..
                              string.format("%.1f", 5 - elapsedTime) ..
                              " วินาที)")
                    return 4
                end
            end
        end
    end
    return step
end

-- เรียกใช้งานแบบ timer (ทุก 1 วินาที)
local function StartSenderStepLoop()
    spawn(function()
        while true do
            local success, err = pcall(function()
                local previousStep = currentStep
                currentStep = TradeStepHandlerSender(currentStep)

                -- ถ้า step เปลี่ยน แสดงว่าขั้นตอนเสร็จแล้ว
                if previousStep ~= currentStep then
                    print(
                        "🔄 ขั้นตอนเปลี่ยนจาก " ..
                            previousStep .. " เป็น " .. currentStep)
                end
            end)
            if not success then
                warn(
                    "❌ เกิดข้อผิดพลาดใน TradeStepHandlerSender: " ..
                        tostring(err))
                currentStep = 0
                -- รีเซ็ตสถานะ sender tracking
                senderShroomStartTime = 0
                senderShroomRequested = false
                senderTokenStartTime = 0
                senderTokenRequested = false
                senderCreatureStartTime = 0
                senderCreatureRequested = false
                senderAcceptStartTime = 0
                senderAcceptRequested = false
                isSenderMainActive = false
            end

            -- รอ 1 วินาทีแล้ววนใหม่
            wait(1)
        end
    end)
end

-- Coroutine สำหรับ Receiver แบบปลอดภัย
local function ReceiverCoroutine()
    while true do
        local success, error = pcall(function()
            -- ตรวจสอบ coins ก่อน
            local coinsValue = LocalPlayer.Data.Coins.Value
            if coinsValue <= 20 then
                print("💰 Coins ไม่เพียงพอ (" ..
                          coinsValue ..
                          " <= 20) Receiver ไม่ทำงาน")
                wait(10) -- รอ 10 วินาทีก่อนตรวจสอบใหม่
                return
            end

            -- ตรวจสอบ TradeGui อย่างปลอดภัย
            local tradeGuiEnabled = false
            local tradeGui = LocalPlayer.PlayerGui:FindFirstChild("TradeGui")
            if tradeGui then tradeGuiEnabled = tradeGui.Enabled end

            if not tradeGuiEnabled then
                -- รอ trade request
                AcceptTradeRequestReceiver()

                -- ตรวจสอบ timeout (เพิ่มใหม่)
                local timeSinceLastRequest = tick() - lastTradeRequestTime
                local timeRemaining = RECEIVER_TIMEOUT - timeSinceLastRequest

                if timeSinceLastRequest >= RECEIVER_TIMEOUT then
                    print(
                        "⚠️ Receiver ไม่ได้รับ trade request นาน " ..
                            string.format("%.1f", timeSinceLastRequest) ..
                            " วินาที (เกิน " ..
                            RECEIVER_TIMEOUT .. " วินาที)")
                    print(
                        "🔄 กำลังเปลี่ยนเซิร์ฟเวอร์เพื่อหาคู่เทรดใหม่...")

                    local success, error = pcall(function()
                        local TeleportService = game:GetService(
                                                    "TeleportService")
                        TeleportService:Teleport(14119723130)
                    end)

                    if not success then
                        warn(
                            "❌ เกิดข้อผิดพลาดในการเปลี่ยนเซิร์ฟเวอร์: " ..
                                tostring(error))
                        print(
                            "🚪 กำลังออกจากเกม...")
                        game:Shutdown()
                    end
                    return
                else
                    -- แสดงสถานะเวลาที่เหลือทุก 30 วินาที
                    if math.floor(timeSinceLastRequest) % 30 == 0 or
                        timeRemaining <= 60 then
                        print(
                            "⏰ Receiver รอ trade request... เหลือเวลาอีก " ..
                                string.format("%.0f", timeRemaining) ..
                                " วินาทีก่อนเปลี่ยนเซิร์ฟเวอร์")
                    end
                end

                -- รีเซ็ตสถานะเมื่อไม่ได้เทรด
                receiverCreatureStartTime = 0
                receiverCreatureRequested = false
                receiverAcceptStartTime = 0
                receiverAcceptRequested = false
                currentStepReceiver = 0
                wait(2)
            else
                -- กำลังเทรดอยู่
                if currentStepReceiver == 0 then
                    -- เช็คชื่อคู่เทรดก่อน
                    if CheckTradePartner() then
                        currentStepReceiver = 1
                        print(
                            "🚀 Receiver เริ่มขั้นตอนที่ 1: Add Creature")
                        -- รีเซ็ตสถานะก่อนเริ่มใหม่
                        receiverCreatureStartTime = 0
                        receiverCreatureRequested = false
                        receiverAcceptStartTime = 0
                        receiverAcceptRequested = false
                    else
                        wait(1)
                    end
                elseif currentStepReceiver == 1 then
                    -- Add Creature - ใช้ state-based tracking แบบปรับปรุง
                    if not receiverCreatureRequested then
                        -- ตรวจสอบว่า remote กำลังใช้งานอยู่หรือไม่
                        if isRemoteBusy then
                            print(
                                "⏳ Receiver: Remote กำลังใช้งานอยู่ รอสักครู่...")
                            wait(1)
                        else
                            print(
                                "🚀 Receiver เริ่ม Add Creature...")
                            receiverCreatureRequested = true
                            receiverCreatureStartTime = tick()

                            -- เรียก AddCreatureReceiver แบบ synchronous พร้อม error handling
                            local creatureSuccess = false
                            local attemptSuccess, attemptError = pcall(
                                                                     function()
                                    creatureSuccess = AddCreatureReceiver()
                                end)

                            if attemptSuccess and creatureSuccess then
                                print(
                                    "✅ Receiver Add Creature เสร็จสิ้น")
                                currentStepReceiver = 2
                                print(
                                    "🚀 Receiver เริ่มขั้นตอนที่ 2: Click Accept")
                            else
                                warn(
                                    "❌ Receiver Add Creature ล้มเหลว: " ..
                                        tostring(attemptError))
                                -- รีเซ็ตเพื่อลองใหม่
                                receiverCreatureRequested = false
                                receiverCreatureStartTime = 0
                                wait(2) -- รอก่อนลองใหม่
                            end
                        end
                    else
                        -- ตรวจสอบว่าผ่านไป 10 วินาทีแล้วหรือยัง (เพิ่มเวลา)
                        local elapsedTime = tick() - receiverCreatureStartTime
                        if elapsedTime >= 10 then
                            print(
                                "⚠️ Receiver Add Creature ใช้เวลานานเกินไป กำลังข้ามไป step 2")
                            currentStepReceiver = 2
                            print(
                                "🚀 Receiver เริ่มขั้นตอนที่ 2: Click Accept")
                        else
                            print(
                                "⏳ Receiver รอ Add Creature เสร็จ... (" ..
                                    string.format("%.1f", 10 - elapsedTime) ..
                                    " วินาที)")
                        end
                    end
                elseif currentStepReceiver == 2 then
                    -- Click Accept - ใช้ state-based tracking แบบปรับปรุง
                    if not receiverAcceptRequested then
                        -- ตรวจสอบว่า remote ยังใช้งานอยู่หรือไม่
                        if isRemoteBusy then
                            print(
                                "⚠️ Receiver: Remote ยังใช้งานอยู่ ไม่สามารถกด accept ได้! รอสักครู่...")
                            wait(1)
                        else
                            print(
                                "🚀 Receiver เริ่ม Click Accept...")
                            receiverAcceptRequested = true
                            receiverAcceptStartTime = tick()

                            -- เรียก ClickAcceptReceiver แบบ synchronous พร้อม error handling
                            local acceptSuccess = false
                            local attemptSuccess, attemptError = pcall(
                                                                     function()
                                    acceptSuccess = ClickAcceptReceiver()
                                end)

                            if attemptSuccess and acceptSuccess then
                                print(
                                    "✅ Receiver เทรดเสร็จสิ้น")
                                currentStepReceiver = 0
                                -- รีเซ็ตสถานะ
                                receiverCreatureStartTime = 0
                                receiverCreatureRequested = false
                                receiverAcceptStartTime = 0
                                receiverAcceptRequested = false
                            else
                                warn(
                                    "❌ Receiver Click Accept ล้มเหลว: " ..
                                        tostring(attemptError))
                                -- รีเซ็ตเพื่อลองใหม่
                                receiverAcceptRequested = false
                                receiverAcceptStartTime = 0
                                wait(2) -- รอก่อนลองใหม่
                            end
                        end
                    else
                        -- ตรวจสอบว่าผ่านไป 5 วินาทีแล้วหรือยัง (เพิ่มเวลา)
                        local elapsedTime = tick() - receiverAcceptStartTime
                        if elapsedTime >= 5 then
                            print(
                                "⚠️ Receiver Click Accept ใช้เวลานานเกินไป กำลังจบเทรด")
                            print(
                                "✅ Receiver เทรดเสร็จสิ้น")
                            currentStepReceiver = 0
                            -- รีเซ็ตสถานะ
                            receiverCreatureStartTime = 0
                            receiverCreatureRequested = false
                            receiverAcceptStartTime = 0
                            receiverAcceptRequested = false
                        else
                            print(
                                "⏳ Receiver รอ Click Accept เสร็จ... (" ..
                                    string.format("%.1f", 5 - elapsedTime) ..
                                    " วินาที)")
                        end
                    end
                end
                wait(1)
            end
        end)

        if not success then
            warn(
                "❌ เกิดข้อผิดพลาดใน ReceiverCoroutine: " ..
                    tostring(error))
            currentStepReceiver = 0
            -- รีเซ็ตสถานะ
            receiverCreatureStartTime = 0
            receiverCreatureRequested = false
            receiverAcceptStartTime = 0
            receiverAcceptRequested = false
            wait(5) -- รอ 5 วินาทีก่อนลองใหม่
        end
    end
end

-- Coroutine ปิดหน้าต่าง CreatureInventoryFrame อัตโนมัติ (ทำงานเบื้องหลังตลอดเวลา)
local function InventoryCloserCoroutine()
    spawn(function()
        while true do
            local success, error = pcall(function()
                local playerGui = LocalPlayer and LocalPlayer.PlayerGui
                if not playerGui then return end

                local tradeHudGui = playerGui:FindFirstChild("TradeHUDGui")
                if not tradeHudGui then return end

                local bottomFrame = tradeHudGui:FindFirstChild("BottomFrame")
                if not bottomFrame then return end

                local creatureInventoryFrame =
                    bottomFrame:FindFirstChild("CreatureInventoryFrame")
                if not creatureInventoryFrame then return end

                if creatureInventoryFrame.Visible == true then
                    local closeButton = creatureInventoryFrame:FindFirstChild(
                                            "CloseButton")
                    local upperLabel = closeButton and
                                           closeButton:FindFirstChild(
                                               "UpperLabel")
                    if upperLabel then
                        local safetyCounter = 0
                        while creatureInventoryFrame.Visible == true and
                            safetyCounter < 30 do
                            Clicked_Ui(upperLabel)
                            task.wait(0.1)
                            Click_NOW()
                            task.wait(0.2)
                            safetyCounter = safetyCounter + 1
                        end
                    end
                end
            end)
            if not success then
                warn(
                    "❌ เกิดข้อผิดพลาดใน InventoryCloserCoroutine: " ..
                        tostring(error))
            end
            wait(0.5)
        end
    end)
end

-- ฟังก์ชันหลัก
local function Main()
    local success, error = pcall(function()
        print("🎮 เริ่มต้นสคริปต์ Trade")

        -- วาร์ปไปยังตำแหน่งที่กำหนด (ทำงานใน background)
        task.spawn(WarpToLocation)

        -- เริ่ม coroutine ปิด CreatureInventoryFrame อัตโนมัติ
        InventoryCloserCoroutine()

        -- ตรวจสอบว่าเป็น Sender หรือ Receiver
        local isSender = IsInList(LocalPlayer.Name, SENDER_LIST)
        local isReceiver = IsInList(LocalPlayer.Name, RECEIVER_LIST)

        if isSender then
            print("👤 ทำงานในโหมด Sender")
            -- รีเซ็ตเวลาเริ่มต้นสำหรับ sender (สำหรับโหมด receiver) (เพิ่มใหม่)
            lastTradeRequestTime = tick()
            StartSenderStepLoop()
            -- เพิ่มการทำงานแบบ Receiver สำหรับ Sender
            coroutine.wrap(SenderReceiverCoroutine)()
        elseif isReceiver then
            print("👤 ทำงานในโหมด Receiver")
            -- รีเซ็ตเวลาเริ่มต้นสำหรับ receiver (เพิ่มใหม่)
            lastTradeRequestTime = tick()
            coroutine.wrap(ReceiverCoroutine)()
        else
            print(
                "❌ ชื่อผู้เล่นไม่ตรงกับรายชื่อใดๆ")
        end
    end)

    if not success then
        warn(
            "❌ เกิดข้อผิดพลาดในฟังก์ชันหลัก: " ..
                tostring(error))
        -- ลองรันใหม่หลังจาก 10 วินาที
        wait(10)
        Main()
    end
end

-- เริ่มต้นสคริปต์
Main()
